import{u as Ur,r as c,e as qr,j as r,c as Me,a as He,g as _e,b as Hr,d as ht,f as Ve,h as tr,P as At,F as An,i as _r,k as nt,l as be,s as we,M as Vr,m as Gr,n as on,T as R,o as F,p as Zr,B as y,O as Xr,I as ke,q as Tt,L as Mt,t as nr,v as an,C as Yr,w as Kr,R as X,x as st,y as ln,z as Jr,A as Qr,D as bt,E as es,G as $e}from"./index-NTZrHbBZ.js";import{T as ts,D as ns}from"./TopBar-CRsuKW5c.js";import{i as rs,u as ss,F as os,B as H,A as rr,T as z,a as ve,S as Xt,b as rt,I as Tn}from"./Add-Dt6CNlk6.js";import{E as is,D as kt,L as Lt,F as sr,a as ye,C as Le,R as cn,b as dn,S as as,T as ls,c as cs,d as ds,e as Ut,f as ee,g as us,h as fs}from"./Edit-B9AW6gGH.js";import{C as Yt,a as Kt,b as Ct}from"./Chip-DkHel--L.js";import{s as hs,u as ps,S as qe,C as qt,A as or}from"./CheckCircle-D79ibSAn.js";import{M as lt,S as ms}from"./Search-CJiULAui.js";const gs=(e,t)=>e.filter(n=>t.includes(n)),Ge=(e,t,n)=>{const s=e.keys[0];Array.isArray(t)?t.forEach((o,i)=>{n((a,l)=>{i<=e.keys.length-1&&(i===0?Object.assign(a,l):a[e.up(e.keys[i])]=l)},o)}):t&&typeof t=="object"?(Object.keys(t).length>e.keys.length?e.keys:gs(e.keys,Object.keys(t))).forEach(i=>{if(e.keys.includes(i)){const a=t[i];a!==void 0&&n((l,d)=>{s===i?Object.assign(l,d):l[e.up(i)]=d},a)}}):(typeof t=="number"||typeof t=="string")&&n((o,i)=>{Object.assign(o,i)},t)};function St(e){return`--Grid-${e}Spacing`}function zt(e){return`--Grid-parent-${e}Spacing`}const Mn="--Grid-columns",Be="--Grid-parent-columns",xs=({theme:e,ownerState:t})=>{const n={};return Ge(e.breakpoints,t.size,(s,o)=>{let i={};o==="grow"&&(i={flexBasis:0,flexGrow:1,maxWidth:"100%"}),o==="auto"&&(i={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof o=="number"&&(i={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${o} / var(${Be}) - (var(${Be}) - ${o}) * (var(${zt("column")}) / var(${Be})))`}),s(n,i)}),n},vs=({theme:e,ownerState:t})=>{const n={};return Ge(e.breakpoints,t.offset,(s,o)=>{let i={};o==="auto"&&(i={marginLeft:"auto"}),typeof o=="number"&&(i={marginLeft:o===0?"0px":`calc(100% * ${o} / var(${Be}) + var(${zt("column")}) * ${o} / var(${Be}))`}),s(n,i)}),n},bs=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={[Mn]:12};return Ge(e.breakpoints,t.columns,(s,o)=>{const i=o??12;s(n,{[Mn]:i,"> *":{[Be]:i}})}),n},ys=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={};return Ge(e.breakpoints,t.rowSpacing,(s,o)=>{const i=typeof o=="string"?o:e.spacing?.(o);s(n,{[St("row")]:i,"> *":{[zt("row")]:i}})}),n},ws=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={};return Ge(e.breakpoints,t.columnSpacing,(s,o)=>{const i=typeof o=="string"?o:e.spacing?.(o);s(n,{[St("column")]:i,"> *":{[zt("column")]:i}})}),n},js=({theme:e,ownerState:t})=>{if(!t.container)return{};const n={};return Ge(e.breakpoints,t.direction,(s,o)=>{s(n,{flexDirection:o})}),n},Cs=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${St("row")}) var(${St("column")})`}}),Ss=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{s!==!1&&s!==void 0&&t.push(`grid-${n}-${String(s)}`)}),t},Ds=(e,t="xs")=>{function n(s){return s===void 0?!1:typeof s=="string"&&!Number.isNaN(Number(s))||typeof s=="number"&&s>0}if(n(e))return[`spacing-${t}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const s=[];return Object.entries(e).forEach(([o,i])=>{n(i)&&s.push(`spacing-${o}-${String(i)}`)}),s}return[]},Rs=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([t,n])=>`direction-${t}-${n}`):[`direction-xs-${String(e)}`];function Es(e,t){e.item!==void 0&&delete e.item,e.zeroMinWidth!==void 0&&delete e.zeroMinWidth,t.keys.forEach(n=>{e[n]!==void 0&&delete e[n]})}const Is=Hr(),As=hs("div",{name:"MuiGrid",slot:"Root"});function Ts(e){return ps({props:e,name:"MuiGrid",defaultTheme:Is})}function Ms(e={}){const{createStyledComponent:t=As,useThemeProps:n=Ts,useTheme:s=Ur,componentName:o="MuiGrid"}=e,i=(u,p)=>{const{container:f,direction:g,spacing:m,wrap:x,size:b}=u,h={root:["root",f&&"container",x!=="wrap"&&`wrap-xs-${String(x)}`,...Rs(g),...Ss(b),...f?Ds(m,p.breakpoints.keys[0]):[]]};return He(h,C=>_e(o,C),{})};function a(u,p,f=()=>!0){const g={};return u===null||(Array.isArray(u)?u.forEach((m,x)=>{m!==null&&f(m)&&p.keys[x]&&(g[p.keys[x]]=m)}):typeof u=="object"?Object.keys(u).forEach(m=>{const x=u[m];x!=null&&f(x)&&(g[m]=x)}):g[p.keys[0]]=u),g}const l=t(bs,ws,ys,xs,js,Cs,vs),d=c.forwardRef(function(p,f){const g=s(),m=n(p),x=qr(m);Es(x,g.breakpoints);const{className:b,children:h,columns:C=12,container:w=!1,component:v="div",direction:S="row",wrap:D="wrap",size:E={},offset:I={},spacing:j=0,rowSpacing:T=j,columnSpacing:k=j,unstable_level:A=0,..._}=x,P=a(E,g.breakpoints,V=>V!==!1),$=a(I,g.breakpoints),oe=p.columns??(A?void 0:C),je=p.spacing??(A?void 0:j),B=p.rowSpacing??p.spacing??(A?void 0:T),ce=p.columnSpacing??p.spacing??(A?void 0:k),G={...x,level:A,columns:oe,container:w,direction:S,wrap:D,spacing:je,rowSpacing:B,columnSpacing:ce,size:P,offset:$},pe=i(G,g);return r.jsx(l,{ref:f,as:v,ownerState:G,className:Me(pe.root,b),..._,children:c.Children.map(h,V=>c.isValidElement(V)&&rs(V,["Grid"])&&w&&V.props.container?c.cloneElement(V,{unstable_level:V.props?.unstable_level??A+1}):V)})});return d.muiName="Grid",d}function ks(e){return _e("MuiDialog",e)}const Ht=ht("MuiDialog",["root","backdrop","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ir=c.createContext({}),Ls=we(Gr,{name:"MuiDialog",slot:"Backdrop"})({zIndex:-1}),zs=e=>{const{classes:t,scroll:n,maxWidth:s,fullWidth:o,fullScreen:i}=e,a={root:["root"],backdrop:["backdrop"],container:["container",`scroll${be(n)}`],paper:["paper",`paperScroll${be(n)}`,`paperWidth${be(String(s))}`,o&&"paperFullWidth",i&&"paperFullScreen"]};return He(a,ks,t)},Ps=we(Vr,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),Os=we("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.container,t[`scroll${be(n.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Fs=we(At,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.paper,t[`scrollPaper${be(n.scroll)}`],t[`paperWidth${be(String(n.maxWidth))}`],n.fullWidth&&t.paperFullWidth,n.fullScreen&&t.paperFullScreen]}})(on(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:t})=>!t.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${Ht.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(t=>t!=="xs").map(t=>({props:{maxWidth:t},style:{maxWidth:`${e.breakpoints.values[t]}${e.breakpoints.unit}`,[`&.${Ht.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:t})=>t.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:t})=>t.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Ht.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),ar=c.forwardRef(function(t,n){const s=Ve({props:t,name:"MuiDialog"}),o=tr(),i={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{"aria-describedby":a,"aria-labelledby":l,"aria-modal":d=!0,BackdropComponent:u,BackdropProps:p,children:f,className:g,disableEscapeKeyDown:m=!1,fullScreen:x=!1,fullWidth:b=!1,maxWidth:h="sm",onClick:C,onClose:w,open:v,PaperComponent:S=At,PaperProps:D={},scroll:E="paper",slots:I={},slotProps:j={},TransitionComponent:T=An,transitionDuration:k=i,TransitionProps:A,..._}=s,P={...s,disableEscapeKeyDown:m,fullScreen:x,fullWidth:b,maxWidth:h,scroll:E},$=zs(P),oe=c.useRef(),je=ne=>{oe.current=ne.target===ne.currentTarget},B=ne=>{C&&C(ne),oe.current&&(oe.current=null,w&&w(ne,"backdropClick"))},ce=_r(l),G=c.useMemo(()=>({titleId:ce}),[ce]),pe={transition:T,...I},V={transition:A,paper:D,backdrop:p,...j},O={slots:pe,slotProps:V},[ie,me]=nt("root",{elementType:Ps,shouldForwardComponentProp:!0,externalForwardedProps:O,ownerState:P,className:Me($.root,g),ref:n}),[Ae,Z]=nt("backdrop",{elementType:Ls,shouldForwardComponentProp:!0,externalForwardedProps:O,ownerState:P,className:$.backdrop}),[ze,de]=nt("paper",{elementType:Fs,shouldForwardComponentProp:!0,externalForwardedProps:O,ownerState:P,className:Me($.paper,D.className)}),[ae,L]=nt("container",{elementType:Os,externalForwardedProps:O,ownerState:P,className:$.container}),[Te,te]=nt("transition",{elementType:An,externalForwardedProps:O,ownerState:P,additionalProps:{appear:!0,in:v,timeout:k,role:"presentation"}});return r.jsx(ie,{closeAfterTransition:!0,slots:{backdrop:Ae},slotProps:{backdrop:{transitionDuration:k,as:u,...Z}},disableEscapeKeyDown:m,onClose:w,open:v,onClick:B,...me,..._,children:r.jsx(Te,{...te,children:r.jsx(ae,{onMouseDown:je,...L,children:r.jsx(ze,{as:S,elevation:24,role:"dialog","aria-describedby":a,"aria-labelledby":ce,"aria-modal":d,...de,children:r.jsx(ir.Provider,{value:G,children:f})})})})})});function Ns(e){return _e("MuiDialogActions",e)}ht("MuiDialogActions",["root","spacing"]);const Ws=e=>{const{classes:t,disableSpacing:n}=e;return He({root:["root",!n&&"spacing"]},Ns,t)},$s=we("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableSpacing&&t.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:e})=>!e.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),kn=c.forwardRef(function(t,n){const s=Ve({props:t,name:"MuiDialogActions"}),{className:o,disableSpacing:i=!1,...a}=s,l={...s,disableSpacing:i},d=Ws(l);return r.jsx($s,{className:Me(d.root,o),ownerState:l,ref:n,...a})});function Bs(e){return _e("MuiDialogContent",e)}ht("MuiDialogContent",["root","dividers"]);function Us(e){return _e("MuiDialogTitle",e)}const qs=ht("MuiDialogTitle",["root"]),Hs=e=>{const{classes:t,dividers:n}=e;return He({root:["root",n&&"dividers"]},Bs,t)},_s=we("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dividers&&t.dividers]}})(on(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:t})=>t.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:t})=>!t.dividers,style:{[`.${qs.root} + &`]:{paddingTop:0}}}]}))),Jt=c.forwardRef(function(t,n){const s=Ve({props:t,name:"MuiDialogContent"}),{className:o,dividers:i=!1,...a}=s,l={...s,dividers:i},d=Hs(l);return r.jsx(_s,{className:Me(d.root,o),ownerState:l,ref:n,...a})}),Vs=e=>{const{classes:t}=e;return He({root:["root"]},Us,t)},Gs=we(R,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Qt=c.forwardRef(function(t,n){const s=Ve({props:t,name:"MuiDialogTitle"}),{className:o,id:i,...a}=s,l=s,d=Vs(l),{titleId:u=i}=c.useContext(ir);return r.jsx(Gs,{component:"h2",className:Me(d.root,o),ownerState:l,ref:n,variant:"h6",id:i??u,...a})}),Ln=Ms({createStyledComponent:we("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.container&&t.container]}}),componentName:"MuiGrid",useThemeProps:e=>Ve({props:e,name:"MuiGrid"}),useTheme:tr});function Zs(e){return _e("MuiInputAdornment",e)}const zn=ht("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var Pn;const Xs=(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${be(n.position)}`],n.disablePointerEvents===!0&&t.disablePointerEvents,t[n.variant]]},Ys=e=>{const{classes:t,disablePointerEvents:n,hiddenLabel:s,position:o,size:i,variant:a}=e,l={root:["root",n&&"disablePointerEvents",o&&`position${be(o)}`,a,s&&"hiddenLabel",i&&`size${be(i)}`]};return He(l,Zs,t)},Ks=we("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:Xs})(on(({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${zn.positionStart}&:not(.${zn.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),Js=c.forwardRef(function(t,n){const s=Ve({props:t,name:"MuiInputAdornment"}),{children:o,className:i,component:a="div",disablePointerEvents:l=!1,disableTypography:d=!1,position:u,variant:p,...f}=s,g=ss()||{};let m=p;p&&g.variant,g&&!m&&(m=g.variant);const x={...s,hiddenLabel:g.hiddenLabel,size:g.size,disablePointerEvents:l,position:u,variant:m},b=Ys(x);return r.jsx(os.Provider,{value:null,children:r.jsx(Ks,{as:a,ownerState:x,className:Me(b.root,i),ref:n,...f,children:typeof o=="string"&&!d?r.jsx(R,{color:"textSecondary",children:o}):r.jsxs(c.Fragment,{children:[u==="start"?Pn||(Pn=r.jsx("span",{className:"notranslate","aria-hidden":!0,children:"​"})):null,o]})})})}),lr=F(r.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),Qs=F(r.jsx("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 16H5V10h14zM9 14H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2zm-8 4H7v-2h2zm4 0h-2v-2h2zm4 0h-2v-2h2z"})),eo=F(r.jsx("path",{d:"M18 11v2h4v-2zm-2 6.61c.96.71 2.21 1.65 3.2 2.39.4-.53.8-1.07 1.2-1.6-.99-.74-2.24-1.68-3.2-2.4-.4.54-.8 1.08-1.2 1.61M20.4 5.6c-.4-.53-.8-1.07-1.2-1.6-.99.74-2.24 1.68-3.2 2.4.4.53.8 1.07 1.2 1.6.96-.72 2.21-1.65 3.2-2.4M4 9c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h1v4h2v-4h1l5 3V6L8 9zm11.5 3c0-1.33-.58-2.53-1.5-3.35v6.69c.92-.81 1.5-2.01 1.5-3.34"})),to=F(r.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),no=F(r.jsx("path",{d:"M22 7h-9v2h9zm0 8h-9v2h9zM5.54 11 2 7.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41zm0 8L2 15.46l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41z"})),ro=F(r.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"})),so=F(r.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),oo=F(r.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),io=F(r.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"})),ao=F(r.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),lo=F(r.jsx("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"})),co=F(r.jsx("path",{d:"M3 18h12v-2H3zM3 6v2h18V6zm0 7h18v-2H3z"})),uo=F(r.jsx("path",{d:"m20.5 10 .5-2h-4l1-4h-2l-1 4h-4l1-4h-2L9 8H5l-.5 2h4l-1 4h-4L3 16h4l-1 4h2l1-4h4l-1 4h2l1-4h4l.5-2h-4l1-4zm-7 4h-4l1-4h4z"})),fo=F(r.jsx("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"})),ho=F(r.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"})),po=F(r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})),mo=F(r.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"})),go=F(r.jsx("path",{d:"M2.5 4v3h5v12h3V7h5V4zm19 5h-9v3h3v7h3v-7h3z"})),cr=F(r.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),On=F(r.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),xo=[{id:"form-1",name:"Заявка на консультацию",description:"Форма для сбора заявок на бесплатную консультацию",status:"active",fields:[{id:"f1-name",type:"text",label:"Имя",placeholder:"Введите ваше имя",required:!0},{id:"f1-phone",type:"phone",label:"Телефон",placeholder:"+7 (___) ___-__-__",required:!0},{id:"f1-email",type:"email",label:"Email",placeholder:"example@mail.ru",required:!1},{id:"f1-service",type:"select",label:"Интересующая услуга",placeholder:"Выберите услугу",required:!0,options:["Таргетированная реклама","СМС-рассылки","Email-рассылки","Медийная реклама"]},{id:"f1-message",type:"textarea",label:"Комментарий",placeholder:"Опишите вашу задачу",required:!1}],buttonColor:"#FF0032",buttonText:"Отправить заявку",successMessage:"Спасибо! Мы свяжемся с вами в ближайшее время.",notificationEmail:"leads@company.ru",createdAt:"2026-01-10T10:00:00Z",updatedAt:"2026-02-08T14:30:00Z",leadsCount:47,calledPercent:68,url:"https://forms.example.com/consultation"},{id:"form-2",name:"Подписка на рассылку",description:"Подписка на еженедельный дайджест новостей маркетинга",status:"active",fields:[{id:"f2-name",type:"text",label:"Имя",placeholder:"Как к вам обращаться?",required:!0},{id:"f2-email",type:"email",label:"Email",placeholder:"example@mail.ru",required:!0},{id:"f2-topics",type:"multi-select",label:"Интересующие темы",required:!1,options:["Digital-маркетинг","Аналитика","Кейсы","Новости рынка","Обучение"]},{id:"f2-consent",type:"checkbox",label:"Согласен на обработку персональных данных",required:!0,options:["Да"]}],buttonColor:"#FF0032",buttonText:"Подписаться",successMessage:"Вы успешно подписались на рассылку!",notificationEmail:"marketing@company.ru",createdAt:"2025-12-20T09:00:00Z",updatedAt:"2026-02-10T11:00:00Z",leadsCount:124,calledPercent:45,url:"https://forms.example.com/subscribe"},{id:"form-3",name:"Обратная связь",description:"Форма для сбора отзывов и предложений",status:"draft",fields:[{id:"f3-name",type:"text",label:"Имя",placeholder:"Введите ваше имя",required:!0},{id:"f3-email",type:"email",label:"Email",placeholder:"example@mail.ru",required:!0},{id:"f3-rating",type:"radio",label:"Оценка",required:!0,options:["Отлично","Хорошо","Удовлетворительно","Плохо"]},{id:"f3-message",type:"textarea",label:"Ваш отзыв",placeholder:"Расскажите о вашем опыте",required:!0}],buttonColor:"#FF0032",buttonText:"Отправить отзыв",successMessage:"Спасибо за ваш отзыв!",createdAt:"2026-02-05T16:00:00Z",updatedAt:"2026-02-05T16:00:00Z",leadsCount:0,calledPercent:0}],vo=[{id:"lead-1",formId:"form-1",status:"called",answers:{"f1-name":"Иванов Алексей","f1-phone":"+7 916 123 45 67","f1-email":"a.ivanov@mail.ru","f1-service":"Таргетированная реклама","f1-message":"Хотим запустить рекламу нового продукта в соцсетях"},createdAt:"2026-02-10T14:23:00Z",comments:[{id:"c-1",text:"Перезвонил, договорились о встрече на 12.02",createdAt:"2026-02-10T16:00:00Z"}]},{id:"lead-2",formId:"form-1",status:"called",answers:{"f1-name":"Петрова Мария","f1-phone":"+7 925 987 65 43","f1-email":"petrova.m@gmail.com","f1-service":"СМС-рассылки","f1-message":"Нужна рассылка по базе 50 000 контактов"},createdAt:"2026-02-09T11:15:00Z",comments:[{id:"c-2",text:"Отправил КП на почту",createdAt:"2026-02-09T15:30:00Z"},{id:"c-3",text:"Клиент подтвердил интерес, ждём оплату",createdAt:"2026-02-10T10:00:00Z"}]},{id:"lead-3",formId:"form-1",status:"viewed",answers:{"f1-name":"Сидоров Дмитрий","f1-phone":"+7 903 456 78 90","f1-service":"Email-рассылки"},createdAt:"2026-02-09T09:42:00Z",comments:[]},{id:"lead-4",formId:"form-1",status:"new",answers:{"f1-name":"Козлова Анна","f1-phone":"+7 977 234 56 78","f1-email":"kozlova.anna@yandex.ru","f1-service":"Медийная реклама","f1-message":"Интересует размещение на внешних площадках"},createdAt:"2026-02-08T17:05:00Z",comments:[]},{id:"lead-5",formId:"form-1",status:"called",answers:{"f1-name":"Николаев Сергей","f1-phone":"+7 926 345 67 89","f1-email":"s.nikolaev@company.ru","f1-service":"Таргетированная реклама","f1-message":"Бюджет 500 000 ₽, старт через 2 недели"},createdAt:"2026-02-07T13:20:00Z",comments:[{id:"c-4",text:"Крупный клиент, передал менеджеру Олегу",createdAt:"2026-02-07T14:00:00Z"}]},{id:"lead-6",formId:"form-1",status:"viewed",answers:{"f1-name":"Морозова Елена","f1-phone":"+7 915 678 90 12","f1-service":"СМС-рассылки"},createdAt:"2026-02-06T10:30:00Z",comments:[]},{id:"lead-7",formId:"form-1",status:"called",answers:{"f1-name":"Волков Андрей","f1-phone":"+7 964 789 01 23","f1-email":"volkov@inbox.ru","f1-service":"Email-рассылки","f1-message":"Нужна автоматическая цепочка писем для интернет-магазина"},createdAt:"2026-02-05T08:15:00Z",comments:[{id:"c-5",text:"Созвонились, обсудили ТЗ",createdAt:"2026-02-05T12:00:00Z"}]},{id:"lead-8",formId:"form-1",status:"new",answers:{"f1-name":"Кузнецова Ольга","f1-phone":"+7 909 890 12 34","f1-email":"olga.k@mail.ru","f1-service":"Таргетированная реклама"},createdAt:"2026-02-04T15:45:00Z",comments:[]},{id:"lead-9",formId:"form-1",status:"called",answers:{"f1-name":"Лебедев Павел","f1-phone":"+7 985 901 23 45","f1-service":"Медийная реклама","f1-message":"Региональная кампания на 3 города"},createdAt:"2026-02-03T11:00:00Z",comments:[{id:"c-6",text:"Отказ — бюджет не согласовали",createdAt:"2026-02-04T09:00:00Z"}]},{id:"lead-10",formId:"form-1",status:"viewed",answers:{"f1-name":"Новикова Татьяна","f1-phone":"+7 917 012 34 56","f1-email":"novikova.t@gmail.com","f1-service":"СМС-рассылки","f1-message":"Акция на 8 марта, нужно запустить до конца февраля"},createdAt:"2026-01-30T16:20:00Z",comments:[]},{id:"lead-11",formId:"form-1",status:"called",answers:{"f1-name":"Соколов Максим","f1-phone":"+7 903 123 45 67","f1-email":"sokolov.max@yandex.ru","f1-service":"Таргетированная реклама"},createdAt:"2026-01-28T09:10:00Z",comments:[{id:"c-7",text:"Запустили тестовую кампанию",createdAt:"2026-01-29T14:00:00Z"}]},{id:"lead-12",formId:"form-1",status:"called",answers:{"f1-name":"Федорова Ирина","f1-phone":"+7 926 234 56 78","f1-service":"Email-рассылки","f1-message":"Хотим перенести рассылки с MailChimp"},createdAt:"2026-01-25T13:40:00Z",comments:[{id:"c-8",text:"Помогли с миграцией, клиент доволен",createdAt:"2026-01-27T11:00:00Z"}]},{id:"lead-13",formId:"form-1",status:"new",answers:{"f1-name":"Попов Виталий","f1-phone":"+7 977 345 67 89","f1-email":"vpopov@company.ru","f1-service":"Медийная реклама","f1-message":"Нужна медийная кампания для нового бренда"},createdAt:"2026-01-22T10:55:00Z",comments:[]},{id:"lead-14",formId:"form-1",status:"called",answers:{"f1-name":"Егорова Светлана","f1-phone":"+7 915 456 78 90","f1-email":"egorova.s@mail.ru","f1-service":"СМС-рассылки"},createdAt:"2026-01-18T14:30:00Z",comments:[{id:"c-9",text:"Подписали договор на 3 месяца",createdAt:"2026-01-20T10:00:00Z"}]},{id:"lead-15",formId:"form-2",status:"new",answers:{"f2-name":"Белов Роман","f2-email":"belov.r@gmail.com","f2-topics":["Digital-маркетинг","Кейсы"]},createdAt:"2026-02-10T08:00:00Z",comments:[]},{id:"lead-16",formId:"form-2",status:"new",answers:{"f2-name":"Тимофеева Дарья","f2-email":"timofeeva.d@yandex.ru","f2-topics":["Аналитика","Обучение","Новости рынка"]},createdAt:"2026-02-09T19:30:00Z",comments:[]}],bo={forms:xo,leads:vo};function yo(e,t){switch(t.type){case"ADD_FORM":return{...e,forms:[...e.forms,t.payload]};case"UPDATE_FORM":return{...e,forms:e.forms.map(n=>n.id===t.payload.id?{...n,...t.payload.changes}:n)};case"DELETE_FORM":return{...e,forms:e.forms.filter(n=>n.id!==t.payload),leads:e.leads.filter(n=>n.formId!==t.payload)};case"ADD_FIELD":return{...e,forms:e.forms.map(n=>n.id===t.payload.formId?{...n,fields:[...n.fields,t.payload.field]}:n)};case"UPDATE_FIELD":return{...e,forms:e.forms.map(n=>n.id===t.payload.formId?{...n,fields:n.fields.map(s=>s.id===t.payload.fieldId?{...s,...t.payload.changes}:s)}:n)};case"DELETE_FIELD":return{...e,forms:e.forms.map(n=>n.id===t.payload.formId?{...n,fields:n.fields.filter(s=>s.id!==t.payload.fieldId)}:n)};case"REORDER_FIELDS":return{...e,forms:e.forms.map(n=>{if(n.id!==t.payload.formId)return n;const s=new Map(n.fields.map(i=>[i.id,i])),o=t.payload.fieldIds.map(i=>s.get(i)).filter(i=>i!==void 0);return{...n,fields:o}})};case"ADD_LEAD":return{...e,leads:[...e.leads,t.payload],forms:e.forms.map(n=>n.id===t.payload.formId?{...n,leadsCount:n.leadsCount+1}:n)};case"UPDATE_LEAD_STATUS":return{...e,leads:e.leads.map(n=>n.id===t.payload.leadId?{...n,status:t.payload.status}:n)};case"ADD_LEAD_COMMENT":return{...e,leads:e.leads.map(n=>n.id===t.payload.leadId?{...n,comments:[...n.comments,t.payload.comment]}:n)};case"DELETE_LEAD":return{...e,leads:e.leads.filter(n=>n.id!==t.payload)};default:return e}}const dr=c.createContext(null);function wo({children:e}){const[t,n]=c.useReducer(yo,bo),s=c.useMemo(()=>({state:t,dispatch:n}),[t]);return r.jsx(dr.Provider,{value:s,children:e})}function Ze(){const e=c.useContext(dr);if(!e)throw new Error("useFormsContext must be used within FormsProvider");return e}function un(e){const{state:t}=Ze();return c.useMemo(()=>t.forms.find(n=>n.id===e),[t.forms,e])}function jo(e){const{state:t}=Ze();return c.useMemo(()=>t.leads.filter(n=>n.formId===e),[t.leads,e])}const Co=["Кампании","Шаблоны","Лид-формы","Настройки","Помощь"],So=2;function Do(){const[e,t]=c.useState(So),s=Zr().pathname.includes("/preview");return r.jsx(wo,{children:r.jsxs(y,{sx:{minHeight:"100vh",bgcolor:"background.default",display:"flex",flexDirection:"column"},children:[!s&&r.jsx(ts,{tabs:Co,activeTab:e,onTabChange:o=>t(o)}),r.jsx(y,{sx:{flex:1},children:r.jsx(Xr,{})})]})})}const Ro={draft:"default",active:"success",inactive:"warning"},Eo={draft:"Черновик",active:"Активна",inactive:"Неактивна"},Io=e=>new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"});function Ao({form:e,onEdit:t,onLeads:n,onDelete:s,onCopyLink:o}){return r.jsx(Yt,{elevation:1,sx:{borderRadius:2,height:"100%"},children:r.jsxs(Kt,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[r.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[r.jsx(R,{variant:"h6",sx:{flex:1,pr:1},children:e.name}),r.jsx(Ct,{label:Eo[e.status],color:Ro[e.status],size:"small"})]}),r.jsxs(qe,{direction:"row",spacing:3,sx:{mb:2},children:[r.jsxs(R,{variant:"body2",color:"text.secondary",children:[e.leadsCount," лидов"]}),r.jsxs(R,{variant:"body2",color:"text.secondary",children:[e.calledPercent,"% обзвонено"]})]}),r.jsxs(R,{variant:"caption",color:"text.secondary",sx:{mb:2},children:["Создана: ",Io(e.createdAt)]}),r.jsx(y,{sx:{flex:1}}),r.jsxs(qe,{direction:"row",spacing:1,sx:{pt:2,borderTop:"1px solid",borderColor:"divider"},children:[r.jsx(H,{size:"small",startIcon:r.jsx(is,{}),onClick:t,children:"Редактировать"}),r.jsx(H,{size:"small",startIcon:r.jsx(cr,{}),onClick:n,children:"Лиды"}),o&&r.jsx(H,{size:"small",startIcon:r.jsx(ao,{}),onClick:o,children:"Копировать ссылку"}),r.jsx(y,{sx:{flex:1}}),r.jsx(ke,{size:"small",color:"error",onClick:s,children:r.jsx(kt,{fontSize:"small"})})]})]})})}const To=[{id:"subscription",name:"Форма подписки",description:"Минимальная форма для сбора контактов"},{id:"request",name:"Форма заявки",description:"Форма для сбора заявок с дополнительным контекстом"},{id:"survey",name:"Опрос/Анкета",description:"Форма для опросов и анкетирования"},{id:"blank",name:"С нуля",description:"Создать пустую форму"}];function Mo(){const{state:e,dispatch:t}=Ze(),n=Tt(),[s,o]=c.useState(!1),i=()=>{o(!0)},a=f=>{o(!1),n("/lead-forms/new")},l=f=>{n(`/lead-forms/${f}/edit`)},d=f=>{n(`/lead-forms/${f}/leads`)},u=f=>{confirm("Удалить форму?")&&t({type:"DELETE_FORM",payload:f})},p=f=>{navigator.clipboard.writeText(f)};return r.jsxs(y,{sx:{p:3},children:[r.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[r.jsx(R,{variant:"h5",children:"Лид-формы"}),r.jsx(H,{variant:"contained",startIcon:r.jsx(rr,{}),onClick:i,children:"Создать форму"})]}),r.jsx(Ln,{container:!0,spacing:2,children:e.forms.map(f=>r.jsx(Ln,{size:{xs:12,md:6,lg:4},children:r.jsx(Ao,{form:f,onEdit:()=>l(f.id),onLeads:()=>d(f.id),onDelete:()=>u(f.id),onCopyLink:f.url?()=>p(f.url):void 0})},f.id))}),r.jsxs(ar,{open:s,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[r.jsx(Qt,{children:"Выберите шаблон"}),r.jsx(Jt,{children:r.jsx(Mt,{children:To.map(f=>r.jsx(Lt,{disablePadding:!0,children:r.jsx(nr,{onClick:()=>a(f.id),children:r.jsx(an,{primary:f.name,secondary:f.description})})},f.id))})})]})]})}function ko({formName:e,onNameChange:t,onPreview:n,onPublish:s,onBack:o,saving:i}){return r.jsxs(y,{sx:{height:64,display:"flex",alignItems:"center",justifyContent:"space-between",px:3,borderBottom:"1px solid",borderColor:"divider",bgcolor:"background.paper"},children:[r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:2},children:[r.jsx(H,{startIcon:r.jsx(lr,{}),onClick:o,sx:{textTransform:"none"},children:"Назад"}),r.jsx(z,{value:e,onChange:a=>t(a.target.value),variant:"standard",size:"small",sx:{minWidth:200}}),r.jsx(y,{sx:{display:"flex",alignItems:"center",gap:1},children:i?r.jsxs(r.Fragment,{children:[r.jsx(Yr,{size:14,thickness:5}),r.jsx(R,{variant:"caption",color:"text.secondary",children:"Сохранение..."})]}):r.jsx(R,{variant:"caption",color:"text.secondary",children:"Сохранено"})})]}),r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:1},children:[r.jsx(H,{startIcon:r.jsx(cr,{}),variant:"outlined",onClick:n,sx:{textTransform:"none"},children:"Превью"}),r.jsx(H,{startIcon:r.jsx(ro,{}),variant:"contained",onClick:s,sx:{textTransform:"none"},children:"Опубликовать"})]})]})}const Lo=[{title:"Базовые",fields:[{type:"text",label:"Текст",icon:go},{type:"textarea",label:"Текстовая область",icon:co},{type:"email",label:"Email",icon:io},{type:"phone",label:"Телефон",icon:ho},{type:"number",label:"Число",icon:uo}]},{title:"Выбор",fields:[{type:"select",label:"Выпадающий список",icon:lo},{type:"multi-select",label:"Множественный выбор",icon:no},{type:"radio",label:"Радио-кнопки",icon:po},{type:"checkbox",label:"Чекбоксы",icon:to}]},{title:"Специальные",fields:[{type:"date",label:"Дата",icon:Qs}]}];function zo({onAddField:e}){return r.jsxs(y,{sx:{py:2},children:[r.jsx(R,{variant:"subtitle2",sx:{px:2,mb:1,color:"text.secondary"},children:"Библиотека полей"}),Lo.map(t=>r.jsxs(y,{sx:{mb:2},children:[r.jsx(R,{variant:"caption",sx:{px:2,color:"text.secondary",fontWeight:500},children:t.title}),r.jsx(Mt,{dense:!0,disablePadding:!0,children:t.fields.map(n=>{const s=n.icon;return r.jsx(Lt,{disablePadding:!0,children:r.jsxs(nr,{onClick:()=>e(n.type),sx:{py:.5},children:[r.jsx(Kr,{sx:{minWidth:36},children:r.jsx(s,{fontSize:"small"})}),r.jsx(an,{primary:n.label,primaryTypographyProps:{variant:"body2"}})]})},n.type)})})]},t.title))]})}function Po(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>s=>{t.forEach(o=>o(s))},t)}const Pt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Xe(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function fn(e){return"nodeType"in e}function Y(e){var t,n;return e?Xe(e)?e:fn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function hn(e){const{Document:t}=Y(e);return e instanceof t}function pt(e){return Xe(e)?!1:e instanceof Y(e).HTMLElement}function ur(e){return e instanceof Y(e).SVGElement}function Ye(e){return e?Xe(e)?e.document:fn(e)?hn(e)?e:pt(e)||ur(e)?e.ownerDocument:document:document:document}const he=Pt?c.useLayoutEffect:c.useEffect;function pn(e){const t=c.useRef(e);return he(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return t.current==null?void 0:t.current(...s)},[])}function Oo(){const e=c.useRef(null),t=c.useCallback((s,o)=>{e.current=setInterval(s,o)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ct(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return he(()=>{n.current!==e&&(n.current=e)},t),n}function mt(e,t){const n=c.useRef();return c.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Dt(e){const t=pn(e),n=c.useRef(null),s=c.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,s]}function en(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let _t={};function gt(e,t){return c.useMemo(()=>{if(t)return t;const n=_t[e]==null?0:_t[e]+1;return _t[e]=n,e+"-"+n},[e,t])}function fr(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((i,a)=>{const l=Object.entries(a);for(const[d,u]of l){const p=i[d];p!=null&&(i[d]=p+e*u)}return i},{...t})}}const Ue=fr(1),dt=fr(-1);function Fo(e){return"clientX"in e&&"clientY"in e}function mn(e){if(!e)return!1;const{KeyboardEvent:t}=Y(e.target);return t&&e instanceof t}function No(e){if(!e)return!1;const{TouchEvent:t}=Y(e.target);return t&&e instanceof t}function tn(e){if(No(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Fo(e)?{x:e.clientX,y:e.clientY}:null}const ut=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ut.Translate.toString(e),ut.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Fn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Wo(e){return e.matches(Fn)?e:e.querySelector(Fn)}const $o={display:"none"};function Bo(e){let{id:t,value:n}=e;return X.createElement("div",{id:t,style:$o},n)}function Uo(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return X.createElement("div",{id:t,style:o,role:"status","aria-live":s,"aria-atomic":!0},n)}function qo(){const[e,t]=c.useState("");return{announce:c.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const hr=c.createContext(null);function Ho(e){const t=c.useContext(hr);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function _o(){const[e]=c.useState(()=>new Set),t=c.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[c.useCallback(s=>{let{type:o,event:i}=s;e.forEach(a=>{var l;return(l=a[o])==null?void 0:l.call(a,i)})},[e]),t]}const Vo={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Go={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Zo(e){let{announcements:t=Go,container:n,hiddenTextDescribedById:s,screenReaderInstructions:o=Vo}=e;const{announce:i,announcement:a}=qo(),l=gt("DndLiveRegion"),[d,u]=c.useState(!1);if(c.useEffect(()=>{u(!0)},[]),Ho(c.useMemo(()=>({onDragStart(f){let{active:g}=f;i(t.onDragStart({active:g}))},onDragMove(f){let{active:g,over:m}=f;t.onDragMove&&i(t.onDragMove({active:g,over:m}))},onDragOver(f){let{active:g,over:m}=f;i(t.onDragOver({active:g,over:m}))},onDragEnd(f){let{active:g,over:m}=f;i(t.onDragEnd({active:g,over:m}))},onDragCancel(f){let{active:g,over:m}=f;i(t.onDragCancel({active:g,over:m}))}}),[i,t])),!d)return null;const p=X.createElement(X.Fragment,null,X.createElement(Bo,{id:s,value:o.draggable}),X.createElement(Uo,{id:l,announcement:a}));return n?st.createPortal(p,n):p}var N;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(N||(N={}));function Rt(){}function Nn(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Xo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const le=Object.freeze({x:0,y:0});function pr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function mr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Yo(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Wn(e){let{left:t,top:n,height:s,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+s},{x:t+o,y:n+s}]}function gr(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function $n(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Ko=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=$n(t,t.left,t.top),i=[];for(const a of s){const{id:l}=a,d=n.get(l);if(d){const u=pr($n(d),o);i.push({id:l,data:{droppableContainer:a,value:u}})}}return i.sort(mr)},Jo=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=Wn(t),i=[];for(const a of s){const{id:l}=a,d=n.get(l);if(d){const u=Wn(d),p=o.reduce((g,m,x)=>g+pr(u[x],m),0),f=Number((p/4).toFixed(4));i.push({id:l,data:{droppableContainer:a,value:f}})}}return i.sort(mr)};function Qo(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=o-s,l=i-n;if(s<o&&n<i){const d=t.width*t.height,u=e.width*e.height,p=a*l,f=p/(d+u-p);return Number(f.toFixed(4))}return 0}const ei=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const o=[];for(const i of s){const{id:a}=i,l=n.get(a);if(l){const d=Qo(l,t);d>0&&o.push({id:a,data:{droppableContainer:i,value:d}})}}return o.sort(Yo)};function ti(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function xr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:le}function ni(e){return function(n){for(var s=arguments.length,o=new Array(s>1?s-1:0),i=1;i<s;i++)o[i-1]=arguments[i];return o.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const ri=ni(1);function si(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function oi(e,t,n){const s=si(t);if(!s)return e;const{scaleX:o,scaleY:i,x:a,y:l}=s,d=e.left-a-(1-o)*parseFloat(n),u=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),p=o?e.width/o:e.width,f=i?e.height/i:e.height;return{width:p,height:f,top:u,right:d+p,bottom:u+f,left:d}}const ii={ignoreTransform:!1};function Ke(e,t){t===void 0&&(t=ii);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:p}=Y(e).getComputedStyle(e);u&&(n=oi(n,u,p))}const{top:s,left:o,width:i,height:a,bottom:l,right:d}=n;return{top:s,left:o,width:i,height:a,bottom:l,right:d}}function Bn(e){return Ke(e,{ignoreTransform:!0})}function ai(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function li(e,t){return t===void 0&&(t=Y(e).getComputedStyle(e)),t.position==="fixed"}function ci(e,t){t===void 0&&(t=Y(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function Ot(e,t){const n=[];function s(o){if(t!=null&&n.length>=t||!o)return n;if(hn(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!pt(o)||ur(o)||n.includes(o))return n;const i=Y(e).getComputedStyle(o);return o!==e&&ci(o,i)&&n.push(o),li(o,i)?n:s(o.parentNode)}return e?s(e):n}function vr(e){const[t]=Ot(e,1);return t??null}function Vt(e){return!Pt||!e?null:Xe(e)?e:fn(e)?hn(e)||e===Ye(e).scrollingElement?window:pt(e)?e:null:null}function br(e){return Xe(e)?e.scrollX:e.scrollLeft}function yr(e){return Xe(e)?e.scrollY:e.scrollTop}function nn(e){return{x:br(e),y:yr(e)}}var W;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(W||(W={}));function wr(e){return!Pt||!e?!1:e===document.scrollingElement}function jr(e){const t={x:0,y:0},n=wr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:o,isLeft:i,isBottom:a,isRight:l,maxScroll:s,minScroll:t}}const di={x:.2,y:.2};function ui(e,t,n,s,o){let{top:i,left:a,right:l,bottom:d}=n;s===void 0&&(s=10),o===void 0&&(o=di);const{isTop:u,isBottom:p,isLeft:f,isRight:g}=jr(e),m={x:0,y:0},x={x:0,y:0},b={height:t.height*o.y,width:t.width*o.x};return!u&&i<=t.top+b.height?(m.y=W.Backward,x.y=s*Math.abs((t.top+b.height-i)/b.height)):!p&&d>=t.bottom-b.height&&(m.y=W.Forward,x.y=s*Math.abs((t.bottom-b.height-d)/b.height)),!g&&l>=t.right-b.width?(m.x=W.Forward,x.x=s*Math.abs((t.right-b.width-l)/b.width)):!f&&a<=t.left+b.width&&(m.x=W.Backward,x.x=s*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:x}}function fi(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:s,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:o,width:e.clientWidth,height:e.clientHeight}}function Cr(e){return e.reduce((t,n)=>Ue(t,nn(n)),le)}function hi(e){return e.reduce((t,n)=>t+br(n),0)}function pi(e){return e.reduce((t,n)=>t+yr(n),0)}function mi(e,t){if(t===void 0&&(t=Ke),!e)return;const{top:n,left:s,bottom:o,right:i}=t(e);vr(e)&&(o<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const gi=[["x",["left","right"],hi],["y",["top","bottom"],pi]];class gn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Ot(n),o=Cr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,l]of gi)for(const d of a)Object.defineProperty(this,d,{get:()=>{const u=l(s),p=o[i]-u;return this.rect[d]+p},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ot{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var o;(o=this.target)==null||o.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function xi(e){const{EventTarget:t}=Y(e);return e instanceof t?e:Ye(e)}function Gt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var se;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(se||(se={}));function Un(e){e.preventDefault()}function vi(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const Sr={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},bi=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class xn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ot(Ye(n)),this.windowListeners=new ot(Y(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(se.Resize,this.handleCancel),this.windowListeners.add(se.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(se.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&mi(s),n(le)}handleKeyDown(t){if(mn(t)){const{active:n,context:s,options:o}=this.props,{keyboardCodes:i=Sr,coordinateGetter:a=bi,scrollBehavior:l="smooth"}=o,{code:d}=t;if(i.end.includes(d)){this.handleEnd(t);return}if(i.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=s.current,p=u?{x:u.left,y:u.top}:le;this.referenceCoordinates||(this.referenceCoordinates=p);const f=a(t,{active:n,context:s.current,currentCoordinates:p});if(f){const g=dt(f,p),m={x:0,y:0},{scrollableAncestors:x}=s.current;for(const b of x){const h=t.code,{isTop:C,isRight:w,isLeft:v,isBottom:S,maxScroll:D,minScroll:E}=jr(b),I=fi(b),j={x:Math.min(h===M.Right?I.right-I.width/2:I.right,Math.max(h===M.Right?I.left:I.left+I.width/2,f.x)),y:Math.min(h===M.Down?I.bottom-I.height/2:I.bottom,Math.max(h===M.Down?I.top:I.top+I.height/2,f.y))},T=h===M.Right&&!w||h===M.Left&&!v,k=h===M.Down&&!S||h===M.Up&&!C;if(T&&j.x!==f.x){const A=b.scrollLeft+g.x,_=h===M.Right&&A<=D.x||h===M.Left&&A>=E.x;if(_&&!g.y){b.scrollTo({left:A,behavior:l});return}_?m.x=b.scrollLeft-A:m.x=h===M.Right?b.scrollLeft-D.x:b.scrollLeft-E.x,m.x&&b.scrollBy({left:-m.x,behavior:l});break}else if(k&&j.y!==f.y){const A=b.scrollTop+g.y,_=h===M.Down&&A<=D.y||h===M.Up&&A>=E.y;if(_&&!g.x){b.scrollTo({top:A,behavior:l});return}_?m.y=b.scrollTop-A:m.y=h===M.Down?b.scrollTop-D.y:b.scrollTop-E.y,m.y&&b.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(t,Ue(dt(f,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}xn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Sr,onActivation:o}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(s.start.includes(a)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function qn(e){return!!(e&&"distance"in e)}function Hn(e){return!!(e&&"delay"in e)}class vn{constructor(t,n,s){var o;s===void 0&&(s=xi(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=Ye(a),this.documentListeners=new ot(this.document),this.listeners=new ot(s),this.windowListeners=new ot(Y(a)),this.initialCoordinates=(o=tn(i))!=null?o:le,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(se.Resize,this.handleCancel),this.windowListeners.add(se.DragStart,Un),this.windowListeners.add(se.VisibilityChange,this.handleCancel),this.windowListeners.add(se.ContextMenu,Un),this.documentListeners.add(se.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Hn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(qn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:o}=this.props;o(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(se.Click,vi,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(se.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:o,props:i}=this,{onMove:a,options:{activationConstraint:l}}=i;if(!o)return;const d=(n=tn(t))!=null?n:le,u=dt(o,d);if(!s&&l){if(qn(l)){if(l.tolerance!=null&&Gt(u,l.tolerance))return this.handleCancel();if(Gt(u,l.distance))return this.handleStart()}if(Hn(l)&&Gt(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),a(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const yi={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class bn extends vn{constructor(t){const{event:n}=t,s=Ye(n.target);super(t,yi,s)}}bn.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s?.({event:n}),!0)}}];const wi={move:{name:"mousemove"},end:{name:"mouseup"}};var rn;(function(e){e[e.RightClick=2]="RightClick"})(rn||(rn={}));class ji extends vn{constructor(t){super(t,wi,Ye(t.event.target))}}ji.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===rn.RightClick?!1:(s?.({event:n}),!0)}}];const Zt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ci extends vn{constructor(t){super(t,Zt)}static setup(){return window.addEventListener(Zt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Zt.move.name,t)};function t(){}}}Ci.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:o}=n;return o.length>1?!1:(s?.({event:n}),!0)}}];var it;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(it||(it={}));var Et;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Et||(Et={}));function Si(e){let{acceleration:t,activator:n=it.Pointer,canScroll:s,draggingRect:o,enabled:i,interval:a=5,order:l=Et.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:p,delta:f,threshold:g}=e;const m=Ri({delta:f,disabled:!i}),[x,b]=Oo(),h=c.useRef({x:0,y:0}),C=c.useRef({x:0,y:0}),w=c.useMemo(()=>{switch(n){case it.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case it.DraggableRect:return o}},[n,o,d]),v=c.useRef(null),S=c.useCallback(()=>{const E=v.current;if(!E)return;const I=h.current.x*C.current.x,j=h.current.y*C.current.y;E.scrollBy(I,j)},[]),D=c.useMemo(()=>l===Et.TreeOrder?[...u].reverse():u,[l,u]);c.useEffect(()=>{if(!i||!u.length||!w){b();return}for(const E of D){if(s?.(E)===!1)continue;const I=u.indexOf(E),j=p[I];if(!j)continue;const{direction:T,speed:k}=ui(E,j,w,t,g);for(const A of["x","y"])m[A][T[A]]||(k[A]=0,T[A]=0);if(k.x>0||k.y>0){b(),v.current=E,x(S,a),h.current=k,C.current=T;return}}h.current={x:0,y:0},C.current={x:0,y:0},b()},[t,S,s,b,i,a,JSON.stringify(w),JSON.stringify(m),x,u,D,p,JSON.stringify(g)])}const Di={x:{[W.Backward]:!1,[W.Forward]:!1},y:{[W.Backward]:!1,[W.Forward]:!1}};function Ri(e){let{delta:t,disabled:n}=e;const s=en(t);return mt(o=>{if(n||!s||!o)return Di;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[W.Backward]:o.x[W.Backward]||i.x===-1,[W.Forward]:o.x[W.Forward]||i.x===1},y:{[W.Backward]:o.y[W.Backward]||i.y===-1,[W.Forward]:o.y[W.Forward]||i.y===1}}},[n,t,s])}function Ei(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return mt(o=>{var i;return t==null?null:(i=s??o)!=null?i:null},[s,t])}function Ii(e,t){return c.useMemo(()=>e.reduce((n,s)=>{const{sensor:o}=s,i=o.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,s)}));return[...n,...i]},[]),[e,t])}var ft;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ft||(ft={}));var sn;(function(e){e.Optimized="optimized"})(sn||(sn={}));const _n=new Map;function Ai(e,t){let{dragging:n,dependencies:s,config:o}=t;const[i,a]=c.useState(null),{frequency:l,measure:d,strategy:u}=o,p=c.useRef(e),f=h(),g=ct(f),m=c.useCallback(function(C){C===void 0&&(C=[]),!g.current&&a(w=>w===null?C:w.concat(C.filter(v=>!w.includes(v))))},[g]),x=c.useRef(null),b=mt(C=>{if(f&&!n)return _n;if(!C||C===_n||p.current!==e||i!=null){const w=new Map;for(let v of e){if(!v)continue;if(i&&i.length>0&&!i.includes(v.id)&&v.rect.current){w.set(v.id,v.rect.current);continue}const S=v.node.current,D=S?new gn(d(S),S):null;v.rect.current=D,D&&w.set(v.id,D)}return w}return C},[e,i,n,f,d]);return c.useEffect(()=>{p.current=e},[e]),c.useEffect(()=>{f||m()},[n,f]),c.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),c.useEffect(()=>{f||typeof l!="number"||x.current!==null||(x.current=setTimeout(()=>{m(),x.current=null},l))},[l,f,m,...s]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function h(){switch(u){case ft.Always:return!1;case ft.BeforeDragging:return n;default:return!n}}}function Dr(e,t){return mt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ti(e,t){return Dr(e,t)}function Mi(e){let{callback:t,disabled:n}=e;const s=pn(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return c.useEffect(()=>()=>o?.disconnect(),[o]),o}function Ft(e){let{callback:t,disabled:n}=e;const s=pn(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return c.useEffect(()=>()=>o?.disconnect(),[o]),o}function ki(e){return new gn(Ke(e),e)}function Vn(e,t,n){t===void 0&&(t=ki);const[s,o]=c.useState(null);function i(){o(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d??n)!=null?u:null}const p=t(e);return JSON.stringify(d)===JSON.stringify(p)?d:p})}const a=Mi({callback(d){if(e)for(const u of d){const{type:p,target:f}=u;if(p==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),l=Ft({callback:i});return he(()=>{i(),e?(l?.observe(e),a?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),a?.disconnect())},[e]),s}function Li(e){const t=Dr(e);return xr(e,t)}const Gn=[];function zi(e){const t=c.useRef(e),n=mt(s=>e?s&&s!==Gn&&e&&t.current&&e.parentNode===t.current.parentNode?s:Ot(e):Gn,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function Pi(e){const[t,n]=c.useState(null),s=c.useRef(e),o=c.useCallback(i=>{const a=Vt(i.target);a&&n(l=>l?(l.set(a,nn(a)),new Map(l)):null)},[]);return c.useEffect(()=>{const i=s.current;if(e!==i){a(i);const l=e.map(d=>{const u=Vt(d);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,nn(u)]):null}).filter(d=>d!=null);n(l.length?new Map(l):null),s.current=e}return()=>{a(e),a(i)};function a(l){l.forEach(d=>{const u=Vt(d);u?.removeEventListener("scroll",o)})}},[o,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>Ue(i,a),le):Cr(e):le,[e,t])}function Zn(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const s=e!==le;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?dt(e,n.current):le}function Oi(e){c.useEffect(()=>{if(!Pt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function Fi(e,t){return c.useMemo(()=>e.reduce((n,s)=>{let{eventName:o,handler:i}=s;return n[o]=a=>{i(a,t)},n},{}),[e,t])}function Rr(e){return c.useMemo(()=>e?ai(e):null,[e])}const Xn=[];function Ni(e,t){t===void 0&&(t=Ke);const[n]=e,s=Rr(n?Y(n):null),[o,i]=c.useState(Xn);function a(){i(()=>e.length?e.map(d=>wr(d)?s:new gn(t(d),d)):Xn)}const l=Ft({callback:a});return he(()=>{l?.disconnect(),a(),e.forEach(d=>l?.observe(d))},[e]),o}function Wi(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return pt(t)?t:e}function $i(e){let{measure:t}=e;const[n,s]=c.useState(null),o=c.useCallback(u=>{for(const{target:p}of u)if(pt(p)){s(f=>{const g=t(p);return f?{...f,width:g.width,height:g.height}:g});break}},[t]),i=Ft({callback:o}),a=c.useCallback(u=>{const p=Wi(u);i?.disconnect(),p&&i?.observe(p),s(p?t(p):null)},[t,i]),[l,d]=Dt(a);return c.useMemo(()=>({nodeRef:l,rect:n,setRef:d}),[n,l,d])}const Bi=[{sensor:bn,options:{}},{sensor:xn,options:{}}],Ui={current:{}},jt={draggable:{measure:Bn},droppable:{measure:Bn,strategy:ft.WhileDragging,frequency:sn.Optimized},dragOverlay:{measure:Ke}};class at extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const qi={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new at,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Rt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:jt,measureDroppableContainers:Rt,windowRect:null,measuringScheduled:!1},Hi={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Rt,draggableNodes:new Map,over:null,measureDroppableContainers:Rt},Nt=c.createContext(Hi),Er=c.createContext(qi);function _i(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new at}}}function Vi(e,t){switch(t.type){case N.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case N.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case N.DragEnd:case N.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case N.RegisterDroppable:{const{element:n}=t,{id:s}=n,o=new at(e.droppable.containers);return o.set(s,n),{...e,droppable:{...e.droppable,containers:o}}}case N.SetDroppableDisabled:{const{id:n,key:s,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const a=new at(e.droppable.containers);return a.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case N.UnregisterDroppable:{const{id:n,key:s}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const i=new at(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Gi(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:o}=c.useContext(Nt),i=en(s),a=en(n?.id);return c.useEffect(()=>{if(!t&&!s&&i&&a!=null){if(!mn(i)||document.activeElement===i.target)return;const l=o.get(a);if(!l)return;const{activatorNode:d,node:u}=l;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const p of[d.current,u.current]){if(!p)continue;const f=Wo(p);if(f){f.focus();break}}})}},[s,t,o,a,i]),null}function Zi(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...s}),n):n}function Xi(e){return c.useMemo(()=>({draggable:{...jt.draggable,...e?.draggable},droppable:{...jt.droppable,...e?.droppable},dragOverlay:{...jt.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Yi(e){let{activeNode:t,measure:n,initialRect:s,config:o=!0}=e;const i=c.useRef(!1),{x:a,y:l}=typeof o=="boolean"?{x:o,y:o}:o;he(()=>{if(!a&&!l||!t){i.current=!1;return}if(i.current||!s)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const p=n(u),f=xr(p,s);if(a||(f.x=0),l||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const g=vr(u);g&&g.scrollBy({top:f.y,left:f.x})}},[t,a,l,s,n])}const Ir=c.createContext({...le,scaleX:1,scaleY:1});var Ie;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ie||(Ie={}));const Ki=c.memo(function(t){var n,s,o,i;let{id:a,accessibility:l,autoScroll:d=!0,children:u,sensors:p=Bi,collisionDetection:f=ei,measuring:g,modifiers:m,...x}=t;const b=c.useReducer(Vi,void 0,_i),[h,C]=b,[w,v]=_o(),[S,D]=c.useState(Ie.Uninitialized),E=S===Ie.Initialized,{draggable:{active:I,nodes:j,translate:T},droppable:{containers:k}}=h,A=I!=null?j.get(I):null,_=c.useRef({initial:null,translated:null}),P=c.useMemo(()=>{var q;return I!=null?{id:I,data:(q=A?.data)!=null?q:Ui,rect:_}:null},[I,A]),$=c.useRef(null),[oe,je]=c.useState(null),[B,ce]=c.useState(null),G=ct(x,Object.values(x)),pe=gt("DndDescribedBy",a),V=c.useMemo(()=>k.getEnabled(),[k]),O=Xi(g),{droppableRects:ie,measureDroppableContainers:me,measuringScheduled:Ae}=Ai(V,{dragging:E,dependencies:[T.x,T.y],config:O.droppable}),Z=Ei(j,I),ze=c.useMemo(()=>B?tn(B):null,[B]),de=Br(),ae=Ti(Z,O.draggable.measure);Yi({activeNode:I!=null?j.get(I):null,config:de.layoutShiftCompensation,initialRect:ae,measure:O.draggable.measure});const L=Vn(Z,O.draggable.measure,ae),Te=Vn(Z?Z.parentElement:null),te=c.useRef({activatorEvent:null,active:null,activeNode:Z,collisionRect:null,collisions:null,droppableRects:ie,draggableNodes:j,draggingNode:null,draggingNodeRect:null,droppableContainers:k,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ne=k.getNodeFor((n=te.current.over)==null?void 0:n.id),ge=$i({measure:O.dragOverlay.measure}),Pe=(s=ge.nodeRef.current)!=null?s:Z,Oe=E?(o=ge.rect)!=null?o:L:null,wn=!!(ge.nodeRef.current&&ge.rect),jn=Li(wn?null:L),Wt=Rr(Pe?Y(Pe):null),Ce=zi(E?ne??Z:null),xt=Ni(Ce),vt=Zi(m,{transform:{x:T.x-jn.x,y:T.y-jn.y,scaleX:1,scaleY:1},activatorEvent:B,active:P,activeNodeRect:L,containerNodeRect:Te,draggingNodeRect:Oe,over:te.current.over,overlayNodeRect:ge.rect,scrollableAncestors:Ce,scrollableAncestorRects:xt,windowRect:Wt}),Cn=ze?Ue(ze,T):null,Sn=Pi(Ce),zr=Zn(Sn),Pr=Zn(Sn,[L]),Fe=Ue(vt,zr),Ne=Oe?ri(Oe,vt):null,Je=P&&Ne?f({active:P,collisionRect:Ne,droppableRects:ie,droppableContainers:V,pointerCoordinates:Cn}):null,Dn=gr(Je,"id"),[Se,Rn]=c.useState(null),Or=wn?vt:Ue(vt,Pr),Fr=ti(Or,(i=Se?.rect)!=null?i:null,L),$t=c.useRef(null),En=c.useCallback((q,K)=>{let{sensor:J,options:De}=K;if($.current==null)return;const re=j.get($.current);if(!re)return;const Q=q.nativeEvent,ue=new J({active:$.current,activeNode:re,event:Q,options:De,context:te,onAbort(U){if(!j.get(U))return;const{onDragAbort:fe}=G.current,xe={id:U};fe?.(xe),w({type:"onDragAbort",event:xe})},onPending(U,Re,fe,xe){if(!j.get(U))return;const{onDragPending:et}=G.current,Ee={id:U,constraint:Re,initialCoordinates:fe,offset:xe};et?.(Ee),w({type:"onDragPending",event:Ee})},onStart(U){const Re=$.current;if(Re==null)return;const fe=j.get(Re);if(!fe)return;const{onDragStart:xe}=G.current,Qe={activatorEvent:Q,active:{id:Re,data:fe.data,rect:_}};st.unstable_batchedUpdates(()=>{xe?.(Qe),D(Ie.Initializing),C({type:N.DragStart,initialCoordinates:U,active:Re}),w({type:"onDragStart",event:Qe}),je($t.current),ce(Q)})},onMove(U){C({type:N.DragMove,coordinates:U})},onEnd:We(N.DragEnd),onCancel:We(N.DragCancel)});$t.current=ue;function We(U){return async function(){const{active:fe,collisions:xe,over:Qe,scrollAdjustedTranslate:et}=te.current;let Ee=null;if(fe&&et){const{cancelDrop:tt}=G.current;Ee={activatorEvent:Q,active:fe,collisions:xe,delta:et,over:Qe},U===N.DragEnd&&typeof tt=="function"&&await Promise.resolve(tt(Ee))&&(U=N.DragCancel)}$.current=null,st.unstable_batchedUpdates(()=>{C({type:U}),D(Ie.Uninitialized),Rn(null),je(null),ce(null),$t.current=null;const tt=U===N.DragEnd?"onDragEnd":"onDragCancel";if(Ee){const Bt=G.current[tt];Bt?.(Ee),w({type:tt,event:Ee})}})}}},[j]),Nr=c.useCallback((q,K)=>(J,De)=>{const re=J.nativeEvent,Q=j.get(De);if($.current!==null||!Q||re.dndKit||re.defaultPrevented)return;const ue={active:Q};q(J,K.options,ue)===!0&&(re.dndKit={capturedBy:K.sensor},$.current=De,En(J,K))},[j,En]),In=Ii(p,Nr);Oi(p),he(()=>{L&&S===Ie.Initializing&&D(Ie.Initialized)},[L,S]),c.useEffect(()=>{const{onDragMove:q}=G.current,{active:K,activatorEvent:J,collisions:De,over:re}=te.current;if(!K||!J)return;const Q={active:K,activatorEvent:J,collisions:De,delta:{x:Fe.x,y:Fe.y},over:re};st.unstable_batchedUpdates(()=>{q?.(Q),w({type:"onDragMove",event:Q})})},[Fe.x,Fe.y]),c.useEffect(()=>{const{active:q,activatorEvent:K,collisions:J,droppableContainers:De,scrollAdjustedTranslate:re}=te.current;if(!q||$.current==null||!K||!re)return;const{onDragOver:Q}=G.current,ue=De.get(Dn),We=ue&&ue.rect.current?{id:ue.id,rect:ue.rect.current,data:ue.data,disabled:ue.disabled}:null,U={active:q,activatorEvent:K,collisions:J,delta:{x:re.x,y:re.y},over:We};st.unstable_batchedUpdates(()=>{Rn(We),Q?.(U),w({type:"onDragOver",event:U})})},[Dn]),he(()=>{te.current={activatorEvent:B,active:P,activeNode:Z,collisionRect:Ne,collisions:Je,droppableRects:ie,draggableNodes:j,draggingNode:Pe,draggingNodeRect:Oe,droppableContainers:k,over:Se,scrollableAncestors:Ce,scrollAdjustedTranslate:Fe},_.current={initial:Oe,translated:Ne}},[P,Z,Je,Ne,j,Pe,Oe,ie,k,Se,Ce,Fe]),Si({...de,delta:T,draggingRect:Ne,pointerCoordinates:Cn,scrollableAncestors:Ce,scrollableAncestorRects:xt});const Wr=c.useMemo(()=>({active:P,activeNode:Z,activeNodeRect:L,activatorEvent:B,collisions:Je,containerNodeRect:Te,dragOverlay:ge,draggableNodes:j,droppableContainers:k,droppableRects:ie,over:Se,measureDroppableContainers:me,scrollableAncestors:Ce,scrollableAncestorRects:xt,measuringConfiguration:O,measuringScheduled:Ae,windowRect:Wt}),[P,Z,L,B,Je,Te,ge,j,k,ie,Se,me,Ce,xt,O,Ae,Wt]),$r=c.useMemo(()=>({activatorEvent:B,activators:In,active:P,activeNodeRect:L,ariaDescribedById:{draggable:pe},dispatch:C,draggableNodes:j,over:Se,measureDroppableContainers:me}),[B,In,P,L,C,pe,j,Se,me]);return X.createElement(hr.Provider,{value:v},X.createElement(Nt.Provider,{value:$r},X.createElement(Er.Provider,{value:Wr},X.createElement(Ir.Provider,{value:Fr},u)),X.createElement(Gi,{disabled:l?.restoreFocus===!1})),X.createElement(Zo,{...l,hiddenTextDescribedById:pe}));function Br(){const q=oe?.autoScrollEnabled===!1,K=typeof d=="object"?d.enabled===!1:d===!1,J=E&&!q&&!K;return typeof d=="object"?{...d,enabled:J}:{enabled:J}}}),Ji=c.createContext(null),Yn="button",Qi="Draggable";function ea(e){let{id:t,data:n,disabled:s=!1,attributes:o}=e;const i=gt(Qi),{activators:a,activatorEvent:l,active:d,activeNodeRect:u,ariaDescribedById:p,draggableNodes:f,over:g}=c.useContext(Nt),{role:m=Yn,roleDescription:x="draggable",tabIndex:b=0}=o??{},h=d?.id===t,C=c.useContext(h?Ir:Ji),[w,v]=Dt(),[S,D]=Dt(),E=Fi(a,t),I=ct(n);he(()=>(f.set(t,{id:t,key:i,node:w,activatorNode:S,data:I}),()=>{const T=f.get(t);T&&T.key===i&&f.delete(t)}),[f,t]);const j=c.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":s,"aria-pressed":h&&m===Yn?!0:void 0,"aria-roledescription":x,"aria-describedby":p.draggable}),[s,m,b,h,x,p.draggable]);return{active:d,activatorEvent:l,activeNodeRect:u,attributes:j,isDragging:h,listeners:s?void 0:E,node:w,over:g,setNodeRef:v,setActivatorNodeRef:D,transform:C}}function ta(){return c.useContext(Er)}const na="Droppable",ra={timeout:25};function sa(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:o}=e;const i=gt(na),{active:a,dispatch:l,over:d,measureDroppableContainers:u}=c.useContext(Nt),p=c.useRef({disabled:n}),f=c.useRef(!1),g=c.useRef(null),m=c.useRef(null),{disabled:x,updateMeasurementsFor:b,timeout:h}={...ra,...o},C=ct(b??s),w=c.useCallback(()=>{if(!f.current){f.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{u(Array.isArray(C.current)?C.current:[C.current]),m.current=null},h)},[h]),v=Ft({callback:w,disabled:x||!a}),S=c.useCallback((j,T)=>{v&&(T&&(v.unobserve(T),f.current=!1),j&&v.observe(j))},[v]),[D,E]=Dt(S),I=ct(t);return c.useEffect(()=>{!v||!D.current||(v.disconnect(),f.current=!1,v.observe(D.current))},[D,v]),c.useEffect(()=>(l({type:N.RegisterDroppable,element:{id:s,key:i,disabled:n,node:D,rect:g,data:I}}),()=>l({type:N.UnregisterDroppable,key:i,id:s})),[s]),c.useEffect(()=>{n!==p.current.disabled&&(l({type:N.SetDroppableDisabled,id:s,key:i,disabled:n}),p.current.disabled=n)},[s,i,n,l]),{active:a,rect:g,isOver:d?.id===s,node:D,over:d,setNodeRef:E}}function yn(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function oa(e,t){return e.reduce((n,s,o)=>{const i=t.get(s);return i&&(n[o]=i),n},Array(e.length))}function yt(e){return e!==null&&e>=0}function ia(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function aa(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ar=e=>{let{rects:t,activeIndex:n,overIndex:s,index:o}=e;const i=yn(t,s,n),a=t[o],l=i[o];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},wt={scaleX:1,scaleY:1},la=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:o,rects:i,overIndex:a}=e;const l=(t=i[n])!=null?t:s;if(!l)return null;if(o===n){const u=i[a];return u?{x:0,y:n<a?u.top+u.height-(l.top+l.height):u.top-l.top,...wt}:null}const d=ca(i,o,n);return o>n&&o<=a?{x:0,y:-l.height-d,...wt}:o<n&&o>=a?{x:0,y:l.height+d,...wt}:{x:0,y:0,...wt}};function ca(e,t,n){const s=e[t],o=e[t-1],i=e[t+1];return s?n<t?o?s.top-(o.top+o.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):o?s.top-(o.top+o.height):0:0}const Tr="Sortable",Mr=X.createContext({activeIndex:-1,containerId:Tr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ar,disabled:{draggable:!1,droppable:!1}});function da(e){let{children:t,id:n,items:s,strategy:o=Ar,disabled:i=!1}=e;const{active:a,dragOverlay:l,droppableRects:d,over:u,measureDroppableContainers:p}=ta(),f=gt(Tr,n),g=l.rect!==null,m=c.useMemo(()=>s.map(E=>typeof E=="object"&&"id"in E?E.id:E),[s]),x=a!=null,b=a?m.indexOf(a.id):-1,h=u?m.indexOf(u.id):-1,C=c.useRef(m),w=!ia(m,C.current),v=h!==-1&&b===-1||w,S=aa(i);he(()=>{w&&x&&p(m)},[w,m,x,p]),c.useEffect(()=>{C.current=m},[m]);const D=c.useMemo(()=>({activeIndex:b,containerId:f,disabled:S,disableTransforms:v,items:m,overIndex:h,useDragOverlay:g,sortedRects:oa(m,d),strategy:o}),[b,f,S.draggable,S.droppable,v,m,h,d,g,o]);return X.createElement(Mr.Provider,{value:D},t)}const ua=e=>{let{id:t,items:n,activeIndex:s,overIndex:o}=e;return yn(n,s,o).indexOf(t)},fa=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:o,items:i,newIndex:a,previousItems:l,previousContainerId:d,transition:u}=e;return!u||!s||l!==i&&o===a?!1:n?!0:a!==o&&t===d},ha={duration:200,easing:"ease"},kr="transform",pa=ut.Transition.toString({property:kr,duration:0,easing:"linear"}),ma={roleDescription:"sortable"};function ga(e){let{disabled:t,index:n,node:s,rect:o}=e;const[i,a]=c.useState(null),l=c.useRef(n);return he(()=>{if(!t&&n!==l.current&&s.current){const d=o.current;if(d){const u=Ke(s.current,{ignoreTransform:!0}),p={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(p.x||p.y)&&a(p)}}n!==l.current&&(l.current=n)},[t,n,s,o]),c.useEffect(()=>{i&&a(null)},[i]),i}function xa(e){let{animateLayoutChanges:t=fa,attributes:n,disabled:s,data:o,getNewIndex:i=ua,id:a,strategy:l,resizeObserverConfig:d,transition:u=ha}=e;const{items:p,containerId:f,activeIndex:g,disabled:m,disableTransforms:x,sortedRects:b,overIndex:h,useDragOverlay:C,strategy:w}=c.useContext(Mr),v=va(s,m),S=p.indexOf(a),D=c.useMemo(()=>({sortable:{containerId:f,index:S,items:p},...o}),[f,o,S,p]),E=c.useMemo(()=>p.slice(p.indexOf(a)),[p,a]),{rect:I,node:j,isOver:T,setNodeRef:k}=sa({id:a,data:D,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...d}}),{active:A,activatorEvent:_,activeNodeRect:P,attributes:$,setNodeRef:oe,listeners:je,isDragging:B,over:ce,setActivatorNodeRef:G,transform:pe}=ea({id:a,data:D,attributes:{...ma,...n},disabled:v.draggable}),V=Po(k,oe),O=!!A,ie=O&&!x&&yt(g)&&yt(h),me=!C&&B,Ae=me&&ie?pe:null,ze=ie?Ae??(l??w)({rects:b,activeNodeRect:P,activeIndex:g,overIndex:h,index:S}):null,de=yt(g)&&yt(h)?i({id:a,items:p,activeIndex:g,overIndex:h}):S,ae=A?.id,L=c.useRef({activeId:ae,items:p,newIndex:de,containerId:f}),Te=p!==L.current.items,te=t({active:A,containerId:f,isDragging:B,isSorting:O,id:a,index:S,items:p,newIndex:L.current.newIndex,previousItems:L.current.items,previousContainerId:L.current.containerId,transition:u,wasDragging:L.current.activeId!=null}),ne=ga({disabled:!te,index:S,node:j,rect:I});return c.useEffect(()=>{O&&L.current.newIndex!==de&&(L.current.newIndex=de),f!==L.current.containerId&&(L.current.containerId=f),p!==L.current.items&&(L.current.items=p)},[O,de,f,p]),c.useEffect(()=>{if(ae===L.current.activeId)return;if(ae!=null&&L.current.activeId==null){L.current.activeId=ae;return}const Pe=setTimeout(()=>{L.current.activeId=ae},50);return()=>clearTimeout(Pe)},[ae]),{active:A,activeIndex:g,attributes:$,data:D,rect:I,index:S,newIndex:de,items:p,isOver:T,isSorting:O,isDragging:B,listeners:je,node:j,overIndex:h,over:ce,setNodeRef:V,setActivatorNodeRef:G,setDroppableNodeRef:k,setDraggableNodeRef:oe,transform:ne??ze,transition:ge()};function ge(){if(ne||Te&&L.current.newIndex===S)return pa;if(!(me&&!mn(_)||!u)&&(O||te))return ut.Transition.toString({...u,property:kr})}}function va(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(s=e?.droppable)!=null?s:t.droppable}}function It(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const ba=[M.Down,M.Right,M.Up,M.Left],ya=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:o,droppableContainers:i,over:a,scrollableAncestors:l}}=t;if(ba.includes(e.code)){if(e.preventDefault(),!n||!s)return;const d=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const g=o.get(f.id);if(g)switch(e.code){case M.Down:s.top<g.top&&d.push(f);break;case M.Up:s.top>g.top&&d.push(f);break;case M.Left:s.left>g.left&&d.push(f);break;case M.Right:s.left<g.left&&d.push(f);break}});const u=Jo({collisionRect:s,droppableRects:o,droppableContainers:d});let p=gr(u,"id");if(p===a?.id&&u.length>1&&(p=u[1].id),p!=null){const f=i.get(n.id),g=i.get(p),m=g?o.get(g.id):null,x=g?.node.current;if(x&&m&&f&&g){const h=Ot(x).some((E,I)=>l[I]!==E),C=Lr(f,g),w=wa(f,g),v=h||!C?{x:0,y:0}:{x:w?s.width-m.width:0,y:w?s.height-m.height:0},S={x:m.left,y:m.top};return v.x&&v.y?S:dt(S,v)}}}};function Lr(e,t){return!It(e)||!It(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function wa(e,t){return!It(e)||!It(t)||!Lr(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}function ja({field:e,isSelected:t,onSelect:n,onDelete:s}){const{attributes:o,listeners:i,setNodeRef:a,transform:l,transition:d,isDragging:u}=xa({id:e.id}),p={transform:ut.Transform.toString(l),transition:d,opacity:u?.5:1};return r.jsxs(At,{ref:a,style:p,elevation:t?2:1,onClick:n,sx:{p:2,mb:2,cursor:"pointer",border:"2px solid",borderColor:t?"primary.main":"transparent",position:"relative","&:hover .delete-button":{opacity:1}},children:[r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[r.jsx(y,{...o,...i,sx:{cursor:"grab",display:"flex"},children:r.jsx(oo,{fontSize:"small",color:"action"})}),r.jsxs(R,{variant:"subtitle2",sx:{flex:1},children:[e.label,e.required&&r.jsx(R,{component:"span",color:"error",sx:{ml:.5},children:"*"})]}),r.jsx(ke,{size:"small",className:"delete-button",onClick:f=>{f.stopPropagation(),s()},sx:{opacity:0,transition:"opacity 0.2s"},children:r.jsx(kt,{fontSize:"small"})})]}),r.jsx(y,{onClick:f=>f.stopPropagation(),children:r.jsx(Ca,{field:e})})]})}function Ca({field:e}){const t=e.placeholder||"";switch(e.type){case"text":case"email":case"phone":case"number":return r.jsx(z,{fullWidth:!0,size:"small",placeholder:t,type:e.type==="number"?"number":"text",disabled:!0});case"textarea":return r.jsx(z,{fullWidth:!0,size:"small",placeholder:t,multiline:!0,rows:3,disabled:!0});case"select":return r.jsx(z,{fullWidth:!0,size:"small",select:!0,placeholder:t,value:"",disabled:!0,children:(e.options||["Вариант 1","Вариант 2"]).map(n=>r.jsx(lt,{value:n,children:n},n))});case"multi-select":return r.jsx(ve,{fullWidth:!0,size:"small",disabled:!0,children:r.jsx(z,{fullWidth:!0,size:"small",select:!0,SelectProps:{multiple:!0},value:[],placeholder:t,disabled:!0,children:(e.options||["Вариант 1","Вариант 2"]).map(n=>r.jsx(lt,{value:n,children:n},n))})});case"radio":return r.jsx(ve,{disabled:!0,children:r.jsx(cn,{children:(e.options||["Вариант 1","Вариант 2"]).map(n=>r.jsx(ye,{value:n,control:r.jsx(dn,{size:"small"}),label:n},n))})});case"checkbox":return r.jsx(sr,{children:(e.options||["Вариант 1","Вариант 2"]).map(n=>r.jsx(ye,{control:r.jsx(Le,{size:"small",disabled:!0}),label:n},n))});case"date":return r.jsx(z,{fullWidth:!0,size:"small",type:"date",disabled:!0,InputLabelProps:{shrink:!0}});default:return null}}function Sa({fields:e,selectedFieldId:t,onSelectField:n,onReorder:s,onDeleteField:o}){const i=Xo(Nn(bn),Nn(xn,{coordinateGetter:ya})),a=l=>{const{active:d,over:u}=l;if(u&&d.id!==u.id){const p=e.findIndex(m=>m.id===d.id),f=e.findIndex(m=>m.id===u.id),g=yn(e,p,f).map(m=>m.id);s(g)}};return e.length===0?r.jsx(y,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(R,{variant:"body1",color:"text.secondary",children:"Добавьте поля из библиотеки слева"})}):r.jsx(y,{sx:{maxWidth:600,mx:"auto"},children:r.jsx(Ki,{sensors:i,collisionDetection:Ko,onDragEnd:a,children:r.jsx(da,{items:e.map(l=>l.id),strategy:la,children:e.map(l=>r.jsx(ja,{field:l,isSelected:t===l.id,onSelect:()=>n(l.id),onDelete:()=>o(l.id)},l.id))})})})}function Da({field:e,onChange:t}){if(!e)return r.jsx(y,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",p:3},children:r.jsx(R,{variant:"body2",color:"text.secondary",align:"center",children:"Выберите поле для редактирования"})});const n=["select","multi-select","radio","checkbox"].includes(e.type),s=()=>{const a=e.options||[];t({options:[...a,`Вариант ${a.length+1}`]})},o=(a,l)=>{const d=[...e.options||[]];d[a]=l,t({options:d})},i=a=>{const l=(e.options||[]).filter((d,u)=>u!==a);t({options:l})};return r.jsxs(y,{sx:{p:2},children:[r.jsx(R,{variant:"subtitle2",sx:{mb:2},children:"Свойства поля"}),r.jsx(z,{fullWidth:!0,label:"Название поля",value:e.label,onChange:a=>t({label:a.target.value}),size:"small",sx:{mb:2}}),r.jsx(z,{fullWidth:!0,label:"Подсказка (placeholder)",value:e.placeholder||"",onChange:a=>t({placeholder:a.target.value}),size:"small",sx:{mb:2}}),r.jsx(z,{fullWidth:!0,label:"Описание под полем",value:e.description||"",onChange:a=>t({description:a.target.value}),size:"small",multiline:!0,rows:2,sx:{mb:2}}),r.jsx(ye,{control:r.jsx(as,{checked:e.required,onChange:a=>t({required:a.target.checked})}),label:"Обязательное поле",sx:{mb:n?2:0}}),n&&r.jsxs(y,{children:[r.jsx(R,{variant:"body2",sx:{mb:1},children:"Варианты ответа"}),r.jsx(Mt,{dense:!0,disablePadding:!0,children:(e.options||[]).map((a,l)=>r.jsxs(Lt,{disablePadding:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[r.jsx(z,{fullWidth:!0,size:"small",value:a,onChange:d=>o(l,d.target.value),placeholder:`Вариант ${l+1}`}),r.jsx(ke,{size:"small",onClick:()=>i(l),disabled:e.options&&e.options.length<=1,children:r.jsx(kt,{fontSize:"small"})})]},l))}),r.jsx(z,{fullWidth:!0,size:"small",placeholder:"Добавить вариант...",InputProps:{endAdornment:r.jsx(ke,{size:"small",onClick:s,edge:"end",children:r.jsx(rr,{fontSize:"small"})})},onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),s())},sx:{mt:1}})]})]})}const Ra=[{value:"#FF0032",label:"МТС Красный"},{value:"#007CFF",label:"Синий"},{value:"#26CD58",label:"Зеленый"},{value:"#1D2023",label:"Черный"}];function Ea({form:e,onChange:t}){return r.jsxs(y,{sx:{p:2},children:[r.jsx(R,{variant:"subtitle2",sx:{mb:2},children:"Настройки формы"}),r.jsxs(qe,{spacing:2,children:[r.jsx(z,{fullWidth:!0,label:"Описание формы",value:e.description||"",onChange:n=>t({description:n.target.value}),size:"small",multiline:!0,rows:3,placeholder:"Краткое описание для внутреннего использования"}),r.jsxs(y,{children:[r.jsx(R,{variant:"body2",sx:{mb:1},children:"Цвет кнопки"}),r.jsx(ve,{fullWidth:!0,children:r.jsx(cn,{value:e.buttonColor,onChange:n=>t({buttonColor:n.target.value}),children:r.jsx(qe,{spacing:1,children:Ra.map(n=>r.jsx(ye,{value:n.value,control:r.jsx(dn,{size:"small"}),label:r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:1},children:[r.jsx(y,{sx:{width:20,height:20,borderRadius:.5,bgcolor:n.value,border:"1px solid rgba(0,0,0,0.1)"}}),r.jsx(R,{variant:"body2",children:n.label})]})},n.value))})})})]}),r.jsx(z,{fullWidth:!0,label:"Текст кнопки отправки",value:e.buttonText,onChange:n=>t({buttonText:n.target.value}),size:"small",placeholder:"Отправить"}),r.jsx(z,{fullWidth:!0,label:"Сообщение после отправки",value:e.successMessage,onChange:n=>t({successMessage:n.target.value}),size:"small",multiline:!0,rows:3,placeholder:"Спасибо! Мы скоро свяжемся с вами."}),r.jsx(z,{fullWidth:!0,label:"Email для уведомлений",value:e.notificationEmail||"",onChange:n=>t({notificationEmail:n.target.value}),size:"small",type:"email",placeholder:"optional@example.com"})]})]})}function Ia({open:e,onClose:t,form:n,onPublish:s}){const o=Tt(),[i,a]=c.useState(!1),[l,d]=c.useState(!1),[u,p]=c.useState(!1),f=n.fields.length>0,g=n.fields.some(v=>v.required),m=f&&g,x=()=>{s(),d(!0)},b=()=>{t(),setTimeout(()=>{a(!1),d(!1),p(!1)},300)},h=()=>{const v=`https://mts.ru/forms/${n.id}`;navigator.clipboard.writeText(v),p(!0),setTimeout(()=>p(!1),2e3)},C=()=>{o(`/prototypes/lead-forms/${n.id}/preview`)},w=()=>{alert("Функция запуска рекламы будет доступна в следующей версии")};return r.jsx(ar,{open:e,onClose:b,maxWidth:"sm",fullWidth:!0,children:l?r.jsxs(r.Fragment,{children:[r.jsxs(Qt,{sx:{textAlign:"center",pt:3},children:[r.jsx(qt,{color:"success",sx:{fontSize:48,mb:1}}),r.jsx(R,{variant:"h6",children:"Форма опубликована!"})]}),r.jsx(Jt,{children:r.jsxs(qe,{spacing:3,sx:{pt:2},children:[r.jsx(z,{fullWidth:!0,label:"Ссылка на форму",value:`https://mts.ru/forms/${n.id}`,InputProps:{readOnly:!0}}),r.jsxs(y,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[r.jsx(H,{variant:"outlined",startIcon:r.jsx(so,{}),onClick:h,sx:{flex:1,minWidth:140},children:u?"Скопировано!":"Копировать ссылку"}),r.jsx(H,{variant:"outlined",startIcon:r.jsx(fo,{}),onClick:C,sx:{flex:1,minWidth:140},children:"Посмотреть форму"})]}),r.jsx(H,{variant:"contained",startIcon:r.jsx(eo,{}),onClick:w,fullWidth:!0,children:"Запустить рекламу"})]})}),r.jsx(kn,{children:r.jsx(H,{onClick:b,children:"Закрыть"})})]}):r.jsxs(r.Fragment,{children:[r.jsx(Qt,{children:"Публикация формы"}),r.jsx(Jt,{children:r.jsxs(qe,{spacing:2,children:[r.jsxs(y,{children:[r.jsx(R,{variant:"subtitle2",sx:{mb:1},children:"Проверка готовности"}),r.jsxs(y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:1},children:[f?r.jsx(qt,{color:"success",fontSize:"small"}):r.jsx(On,{color:"warning",fontSize:"small"}),r.jsx(R,{variant:"body2",children:f?"Форма содержит поля":"Добавьте хотя бы одно поле"})]}),r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:1},children:[g?r.jsx(qt,{color:"success",fontSize:"small"}):r.jsx(On,{color:"warning",fontSize:"small"}),r.jsx(R,{variant:"body2",children:g?"Есть обязательные поля":"Добавьте хотя бы одно обязательное поле"})]})]})]}),!m&&r.jsx(or,{severity:"warning",children:"Для публикации необходимо выполнить все требования"}),r.jsxs(y,{children:[r.jsx(R,{variant:"subtitle2",sx:{mb:1},children:"Для публикации необходимо принять оферту"}),r.jsx(At,{variant:"outlined",sx:{maxHeight:120,overflow:"auto",p:2,bgcolor:"grey.50"},children:r.jsx(R,{variant:"body2",color:"text.secondary",children:"Текст оферты... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."})})]}),r.jsx(ye,{control:r.jsx(Le,{checked:i,onChange:v=>a(v.target.checked)}),label:"Я согласен с офертой и принимаю ответственность"})]})}),r.jsxs(kn,{children:[r.jsx(H,{onClick:b,children:"Отмена"}),r.jsx(H,{variant:"contained",onClick:x,disabled:!i||!m,children:"Опубликовать"})]})]})})}function Kn(){const{id:e}=ln(),t=Tt(),{dispatch:n}=Ze(),s=un(e||""),o=!e,[i,a]=c.useState(()=>s||{id:crypto.randomUUID(),name:"Новая форма",status:"draft",fields:[],buttonColor:"#FF0032",buttonText:"Отправить",successMessage:"Спасибо! Мы скоро свяжемся с вами.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),leadsCount:0,calledPercent:0}),[l,d]=c.useState(null),[u,p]=c.useState(!1),[f,g]=c.useState(!1),m=c.useRef(null),x=c.useMemo(()=>i.fields.find(j=>j.id===l)||null,[i.fields,l]);c.useEffect(()=>(Promise.resolve().then(()=>p(!0)),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{n(o?{type:"ADD_FORM",payload:i}:{type:"UPDATE_FORM",payload:{id:i.id,changes:i}}),p(!1)},500),()=>{m.current&&clearTimeout(m.current)}),[i,o,n]);const b=j=>{a(T=>({...T,name:j,updatedAt:new Date().toISOString()}))},h=j=>{const T={id:crypto.randomUUID(),type:j,label:Aa(j),required:!1,...j==="select"||j==="multi-select"||j==="radio"||j==="checkbox"?{options:["Вариант 1","Вариант 2"]}:{}};a(k=>({...k,fields:[...k.fields,T],updatedAt:new Date().toISOString()})),d(T.id)},C=j=>{l&&a(T=>({...T,fields:T.fields.map(k=>k.id===l?{...k,...j}:k),updatedAt:new Date().toISOString()}))},w=j=>{a(T=>({...T,fields:T.fields.filter(k=>k.id!==j),updatedAt:new Date().toISOString()})),l===j&&d(null)},v=j=>{const T=new Map(i.fields.map(A=>[A.id,A])),k=j.map(A=>T.get(A)).filter(A=>A!==void 0);a(A=>({...A,fields:k,updatedAt:new Date().toISOString()}))},S=()=>{const j="/prototypes/".replace(/\/$/,"");window.open(`${j}/lead-forms/${i.id}/preview`,"_blank")},D=()=>{g(!0)},E=j=>{a(T=>({...T,...j,updatedAt:new Date().toISOString()}))},I=()=>{const j={...i,status:"active",url:`https://mts.ru/forms/${i.id}`,updatedAt:new Date().toISOString()};a(j),n({type:"UPDATE_FORM",payload:{id:i.id,changes:j}}),g(!1)};return r.jsxs(y,{sx:{height:"calc(100vh - 52px)",display:"flex",flexDirection:"column"},children:[r.jsx(ko,{formName:i.name,onNameChange:b,onPreview:S,onPublish:D,onBack:()=>t("/lead-forms"),saving:u}),r.jsxs(y,{sx:{flex:1,display:"flex",overflow:"hidden"},children:[r.jsx(y,{sx:{width:240,borderRight:"1px solid",borderColor:"divider",overflow:"auto"},children:r.jsx(zo,{onAddField:h})}),r.jsx(y,{sx:{flex:1,p:3,overflow:"auto",bgcolor:"grey.50"},children:r.jsx(Sa,{fields:i.fields,selectedFieldId:l,onSelectField:d,onReorder:v,onDeleteField:w})}),r.jsx(y,{sx:{width:300,borderLeft:"1px solid",borderColor:"divider",overflow:"auto"},children:x?r.jsx(Da,{field:x,onChange:C}):r.jsx(Ea,{form:i,onChange:E})})]}),r.jsx(Ia,{open:f,onClose:()=>g(!1),form:i,onPublish:I})]})}function Aa(e){return{text:"Текст",textarea:"Текстовая область",email:"Email",phone:"Телефон",number:"Число",select:"Выпадающий список","multi-select":"Множественный выбор",radio:"Радио-кнопки",checkbox:"Чекбоксы",date:"Дата"}[e]}const Ta=[{value:"all",label:"Все"},{value:"new",label:"Новый"},{value:"viewed",label:"Просмотрен"},{value:"called",label:"Обзвонен"}],Ma=[{value:"7",label:"7 дней"},{value:"30",label:"30 дней"},{value:"all",label:"Все"}];function ka({statusFilter:e,onStatusChange:t,dateFilter:n,onDateChange:s,searchQuery:o,onSearchChange:i}){return r.jsxs(y,{sx:{display:"flex",flexDirection:"column",gap:2},children:[r.jsx(y,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:Ta.map(a=>r.jsx(Ct,{label:a.label,variant:e===a.value?"filled":"outlined",color:e===a.value?"primary":"default",onClick:()=>t(a.value),size:"small"},a.value))}),r.jsxs(y,{sx:{display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[r.jsx(y,{sx:{display:"flex",gap:1},children:Ma.map(a=>r.jsx(Ct,{label:a.label,variant:n===a.value?"filled":"outlined",color:n===a.value?"primary":"default",onClick:()=>s(a.value),size:"small"},a.value))}),r.jsx(y,{sx:{flex:1,minWidth:200},children:r.jsx(z,{size:"small",placeholder:"Поиск по лидам...",value:o,onChange:a=>i(a.target.value),fullWidth:!0,InputProps:{startAdornment:r.jsx(Js,{position:"start",children:r.jsx(ms,{fontSize:"small"})})}})})]})]})}const Jn={new:{label:"Новый",color:"default"},viewed:{label:"Просмотрен",color:"primary"},called:{label:"Обзвонен",color:"success"}},La=e=>new Date(e).toLocaleString("ru-RU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function za({leads:e,selectedLeadId:t,onSelectLead:n}){const s=a=>{const l=Object.keys(a.answers).find(d=>d.includes("name")||d.includes("имя"));return l?String(a.answers[l]):"—"},o=a=>{const l=Object.keys(a.answers).find(u=>u.includes("phone")||u.includes("телефон")),d=Object.keys(a.answers).find(u=>u.includes("email")||u.includes("почта"));return l?String(a.answers[l]):d?String(a.answers[d]):"—"},i=a=>{const l=Object.keys(a.answers).find(u=>u.includes("message")||u.includes("comment")||u.includes("сообщение")||u.includes("комментарий"));if(!l)return null;const d=String(a.answers[l]);return d.length>50?d.slice(0,50)+"...":d};return r.jsx(ls,{sx:{mt:2},children:r.jsxs(cs,{size:"small",children:[r.jsx(ds,{children:r.jsxs(Ut,{children:[r.jsx(ee,{padding:"checkbox",sx:{width:40},children:r.jsx(Le,{size:"small"})}),r.jsx(ee,{sx:{width:140},children:"Дата"}),r.jsx(ee,{children:"Имя"}),r.jsx(ee,{children:"Контакт"}),r.jsx(ee,{sx:{width:120},children:"Статус"}),r.jsx(ee,{children:"Превью"})]})}),r.jsx(us,{children:e.length===0?r.jsx(Ut,{children:r.jsx(ee,{colSpan:6,align:"center",sx:{py:4},children:r.jsx(R,{color:"text.secondary",children:"Нет лидов по выбранным фильтрам"})})}):e.map(a=>r.jsxs(Ut,{hover:!0,selected:a.id===t,onClick:()=>n(a.id),sx:{cursor:"pointer"},children:[r.jsx(ee,{padding:"checkbox",children:r.jsx(Le,{size:"small",checked:a.id===t,onClick:l=>l.stopPropagation()})}),r.jsx(ee,{children:r.jsx(R,{variant:"body2",color:"text.secondary",children:La(a.createdAt)})}),r.jsx(ee,{children:r.jsx(R,{variant:"body2",fontWeight:500,children:s(a)})}),r.jsx(ee,{children:r.jsx(R,{variant:"body2",color:"text.secondary",children:o(a)})}),r.jsx(ee,{children:r.jsx(Ct,{label:Jn[a.status].label,color:Jn[a.status].color,size:"small"})}),r.jsx(ee,{children:r.jsx(R,{variant:"body2",color:"text.secondary",noWrap:!0,children:i(a)||"—"})})]},a.id))})]})})}const Qn={new:{label:"Новый"},viewed:{label:"Просмотрен"},called:{label:"Обзвонен"}},er=e=>new Date(e).toLocaleString("ru-RU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function Pa({lead:e,open:t,onClose:n,form:s,onUpdateStatus:o,onAddComment:i,onDelete:a}){const[l,d]=c.useState("");if(!e)return null;const u=x=>{o(e.id,x)},p=x=>{u(x?"called":"viewed")},f=()=>{l.trim()&&(i(e.id,l.trim()),d(""))},g=()=>{a(e.id)},m=()=>s.fields.map(x=>{const b=e.answers[x.id];if(b===void 0||b==="")return null;const h=Array.isArray(b)?b.join(", "):String(b);return r.jsxs(y,{sx:{mb:2},children:[r.jsx(R,{variant:"caption",color:"text.secondary",children:x.label}),r.jsx(R,{variant:"body2",children:h})]},x.id)});return r.jsxs(Jr,{anchor:"right",open:t,onClose:n,PaperProps:{sx:{width:400}},children:[r.jsxs(y,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx(R,{variant:"h6",children:"Лид"}),r.jsxs(y,{children:[r.jsx(ke,{onClick:g,color:"error",size:"small",sx:{mr:1},children:r.jsx(kt,{})}),r.jsx(ke,{onClick:n,size:"small",children:r.jsx(Qr,{})})]})]}),r.jsx(bt,{}),r.jsxs(y,{sx:{p:2,overflow:"auto",flex:1},children:[r.jsxs(y,{sx:{mb:3},children:[r.jsx(R,{variant:"caption",color:"text.secondary",children:"Дата получения"}),r.jsx(R,{variant:"body2",children:er(e.createdAt)})]}),r.jsxs(y,{sx:{mb:3},children:[r.jsx(R,{variant:"caption",color:"text.secondary",children:"Статус"}),r.jsx(ve,{fullWidth:!0,size:"small",sx:{mt:1},children:r.jsx(Xt,{value:e.status,onChange:x=>u(x.target.value),children:Object.keys(Qn).map(x=>r.jsx(lt,{value:x,children:Qn[x].label},x))})}),r.jsx(ye,{control:r.jsx(Le,{checked:e.status==="called",onChange:x=>p(x.target.checked)}),label:"Обзвонен",sx:{mt:1}})]}),r.jsx(bt,{sx:{my:2}}),r.jsxs(y,{sx:{mb:3},children:[r.jsx(R,{variant:"subtitle2",sx:{mb:2},children:"Ответы"}),m()]}),r.jsx(bt,{sx:{my:2}}),r.jsxs(y,{sx:{mb:3},children:[r.jsx(R,{variant:"subtitle2",sx:{mb:2},children:"Комментарии"}),e.comments.length>0?r.jsx(Mt,{dense:!0,disablePadding:!0,children:e.comments.map(x=>r.jsx(Lt,{disablePadding:!0,sx:{mb:1},children:r.jsx(an,{primary:x.text,secondary:er(x.createdAt),primaryTypographyProps:{variant:"body2"},secondaryTypographyProps:{variant:"caption"}})},x.id))}):r.jsx(R,{variant:"body2",color:"text.secondary",children:"Пока нет комментариев"}),r.jsxs(y,{sx:{display:"flex",gap:1,mt:2},children:[r.jsx(z,{size:"small",placeholder:"Добавить комментарий...",value:l,onChange:x=>d(x.target.value),fullWidth:!0,multiline:!0,rows:2}),r.jsx(H,{variant:"contained",size:"small",onClick:f,disabled:!l.trim(),children:r.jsx(mo,{fontSize:"small"})})]})]}),r.jsx(bt,{sx:{my:2}}),r.jsxs(y,{children:[r.jsx(R,{variant:"subtitle2",sx:{mb:2},children:"История"}),r.jsx(R,{variant:"body2",color:"text.secondary",children:"История изменений будет здесь"})]})]})]})}function Oa(){const{id:e}=ln(),t=Tt(),{dispatch:n}=Ze(),s=un(e||""),o=jo(e||""),[i,a]=c.useState("all"),[l,d]=c.useState("all"),[u,p]=c.useState(""),[f,g]=c.useState(null),[m,x]=c.useState(!1),b=c.useMemo(()=>o.filter(D=>{if(i!=="all"&&D.status!==i)return!1;if(l!=="all"){const E=parseInt(l),I=new Date;if(I.setDate(I.getDate()-E),new Date(D.createdAt)<I)return!1}if(u){const E=u.toLowerCase();return Object.values(D.answers).join(" ").toLowerCase().includes(E)}return!0}),[o,i,l,u]),h=c.useMemo(()=>o.find(D=>D.id===f)||null,[o,f]),C=()=>{x(!0)},w=(D,E)=>{n({type:"UPDATE_LEAD_STATUS",payload:{leadId:D,status:E}})},v=(D,E)=>{n({type:"ADD_LEAD_COMMENT",payload:{leadId:D,comment:{id:crypto.randomUUID(),text:E,createdAt:new Date().toISOString()}}})},S=D=>{confirm("Удалить лид?")&&(n({type:"DELETE_LEAD",payload:D}),g(null))};return s?r.jsxs(y,{sx:{p:3},children:[r.jsxs(y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[r.jsxs(y,{sx:{display:"flex",alignItems:"center",gap:2},children:[r.jsx(ke,{onClick:()=>t("/lead-forms"),children:r.jsx(lr,{})}),r.jsxs(R,{variant:"h5",children:[s.name," — Лиды"]})]}),r.jsx(H,{variant:"outlined",startIcon:r.jsx(ns,{}),onClick:C,children:"Скачать Excel"})]}),r.jsx(ka,{statusFilter:i,onStatusChange:a,dateFilter:l,onDateChange:d,searchQuery:u,onSearchChange:p}),r.jsx(za,{leads:b,selectedLeadId:f,onSelectLead:g}),r.jsx(Pa,{lead:h,open:!!f,onClose:()=>g(null),form:s,onUpdateStatus:w,onAddComment:v,onDelete:S}),r.jsx(fs,{open:m,autoHideDuration:3e3,onClose:()=>x(!1),message:"Файл скачан"})]}):r.jsx(y,{sx:{p:3},children:r.jsx(R,{children:"Форма не найдена"})})}function Fa({form:e,onSubmit:t}){const[n,s]=c.useState({}),[o,i]=c.useState(!1),[a,l]=c.useState(!1),[d,u]=c.useState(!1),[p,f]=c.useState({}),g=()=>{const h={};let C=!1;return e.fields.forEach(w=>{if(w.required){const v=n[w.id];(!v||Array.isArray(v)&&v.length===0||typeof v=="string"&&v.trim()==="")&&(h[w.id]=!0,C=!0)}}),o||(C=!0),f(h),!C},m=()=>{u(!0),g()&&(t(n),l(!0))},x=(h,C)=>{s(w=>({...w,[h]:C})),p[h]&&f(w=>({...w,[h]:!1}))},b=h=>{const C=n[h.id]||"",w=d&&p[h.id];switch(h.type){case"text":case"email":case"phone":return r.jsx(z,{fullWidth:!0,label:h.label,type:h.type==="email"?"email":"text",value:C,onChange:v=>x(h.id,v.target.value),helperText:h.description,required:h.required,error:w,placeholder:h.placeholder});case"number":return r.jsx(z,{fullWidth:!0,label:h.label,type:"number",value:C,onChange:v=>x(h.id,v.target.value),helperText:h.description,required:h.required,error:w,placeholder:h.placeholder});case"textarea":return r.jsx(z,{fullWidth:!0,label:h.label,multiline:!0,rows:3,value:C,onChange:v=>x(h.id,v.target.value),helperText:h.description,required:h.required,error:w,placeholder:h.placeholder});case"select":return r.jsxs(ve,{fullWidth:!0,required:h.required,error:w,children:[r.jsx(Tn,{children:h.label}),r.jsx(Xt,{value:C,onChange:v=>x(h.id,v.target.value),label:h.label,children:h.options?.map(v=>r.jsx(lt,{value:v,children:v},v))}),h.description&&r.jsx(rt,{children:h.description})]});case"multi-select":{const v=n[h.id]||[];return r.jsxs(ve,{fullWidth:!0,required:h.required,error:w,children:[r.jsx(Tn,{children:h.label}),r.jsx(Xt,{multiple:!0,value:v,onChange:S=>{const D=S.target.value;x(h.id,typeof D=="string"?D.split(","):D)},label:h.label,renderValue:S=>S.join(", "),children:h.options?.map(S=>r.jsx(lt,{value:S,children:S},S))}),h.description&&r.jsx(rt,{children:h.description})]})}case"radio":return r.jsxs(ve,{fullWidth:!0,required:h.required,error:w,children:[r.jsxs(R,{variant:"subtitle2",sx:{mb:1},children:[h.label,h.required&&r.jsx(R,{component:"span",color:"error",children:" *"})]}),r.jsx(cn,{value:C,onChange:v=>x(h.id,v.target.value),children:h.options?.map(v=>r.jsx(ye,{value:v,control:r.jsx(dn,{}),label:v},v))}),h.description&&r.jsx(rt,{children:h.description})]});case"checkbox":{const v=n[h.id]||[];return r.jsxs(ve,{fullWidth:!0,required:h.required,error:w,children:[r.jsxs(R,{variant:"subtitle2",sx:{mb:1},children:[h.label,h.required&&r.jsx(R,{component:"span",color:"error",children:" *"})]}),r.jsx(sr,{children:h.options?.map(S=>r.jsx(ye,{control:r.jsx(Le,{checked:v.includes(S),onChange:D=>{D.target.checked?x(h.id,[...v,S]):x(h.id,v.filter(E=>E!==S))}}),label:S},S))}),h.description&&r.jsx(rt,{children:h.description})]})}case"date":return r.jsx(z,{fullWidth:!0,label:h.label,type:"date",value:C,onChange:v=>x(h.id,v.target.value),helperText:h.description,required:h.required,error:w,InputLabelProps:{shrink:!0}});default:return null}};return a?r.jsx(y,{sx:{maxWidth:560,mx:"auto",px:2},children:r.jsx(Yt,{children:r.jsxs(Kt,{sx:{p:4,textAlign:"center"},children:[r.jsx(y,{component:"img",src:"/prototypes/assets/mts-logo.svg",alt:"МТС",sx:{width:40,height:40,mb:3,objectFit:"contain"}}),r.jsx(or,{severity:"success",sx:{justifyContent:"center"},children:r.jsx(R,{variant:"h6",gutterBottom:!0,children:e.successMessage})})]})})}):r.jsx(y,{sx:{maxWidth:560,mx:"auto",px:2},children:r.jsx(Yt,{children:r.jsxs(Kt,{sx:{p:4},children:[r.jsx(y,{sx:{textAlign:"center",mb:3},children:r.jsx(y,{component:"img",src:"/prototypes/assets/mts-logo.svg",alt:"МТС",sx:{width:40,height:40,objectFit:"contain"}})}),r.jsx(R,{variant:"h5",component:"h1",gutterBottom:!0,align:"center",children:e.name}),e.description&&r.jsx(R,{variant:"body2",color:"text.secondary",sx:{mb:3,textAlign:"center"},children:e.description}),r.jsxs(y,{sx:{display:"flex",flexDirection:"column",gap:3,mt:3},children:[e.fields.map(h=>r.jsx(y,{children:b(h)},h.id)),r.jsxs(ve,{error:d&&!o,children:[r.jsx(ye,{control:r.jsx(Le,{checked:o,onChange:h=>i(h.target.checked)}),label:"Я согласен на обработку персональных данных"}),d&&!o&&r.jsx(rt,{error:!0,children:"Необходимо согласие на обработку данных"})]}),r.jsx(H,{variant:"contained",size:"large",fullWidth:!0,onClick:m,sx:{mt:2,bgcolor:e.buttonColor,"&:hover":{bgcolor:e.buttonColor,opacity:.9}},children:e.buttonText})]})]})})})}function Na(){const{id:e}=ln(),t=un(e||""),{dispatch:n}=Ze(),s=o=>{const i={id:crypto.randomUUID(),formId:e||"",status:"new",answers:o,createdAt:new Date().toISOString(),comments:[]};n({type:"ADD_LEAD",payload:i})};return t?r.jsxs(y,{sx:{minHeight:"100vh",bgcolor:"grey.50",py:4},children:[r.jsx(y,{sx:{maxWidth:560,mx:"auto",px:2,mb:2},children:r.jsx(R,{variant:"caption",color:"text.secondary",align:"center",display:"block",children:"Режим предпросмотра — можно закрыть вкладку"})}),r.jsx(Fa,{form:t,onSubmit:s})]}):r.jsx(y,{sx:{p:3,textAlign:"center"},children:r.jsx(R,{children:"Форма не найдена"})})}function Va(){return r.jsx(es,{children:r.jsxs($e,{element:r.jsx(Do,{}),children:[r.jsx($e,{index:!0,element:r.jsx(Mo,{})}),r.jsx($e,{path:"new",element:r.jsx(Kn,{})}),r.jsx($e,{path:":id/edit",element:r.jsx(Kn,{})}),r.jsx($e,{path:":id/leads",element:r.jsx(Oa,{})}),r.jsx($e,{path:":id/preview",element:r.jsx(Na,{})})]})})}export{Va as default};
